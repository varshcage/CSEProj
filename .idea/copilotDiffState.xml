<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/src/main/java/com/pahana_edu/bs/model/User.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/pahana_edu/bs/model/User.java" />
              <option name="updatedContent" value="package com.pahana_edu.bs.model;&#10;&#10;import java.io.Serializable;&#10;&#10;public class User implements Serializable {&#10;    private String username;&#10;    private String password;&#10;&#10;    public User() {&#10;    }&#10;&#10;    public User(String username, String password) {&#10;        this.username = username;&#10;        this.password = password;&#10;    }&#10;&#10;    public String getUsername() {&#10;        return username;&#10;    }&#10;&#10;    public void setUsername(String username) {&#10;        this.username = username;&#10;    }&#10;&#10;    public String getPassword() {&#10;        return password;&#10;    }&#10;&#10;    public void setPassword(String password) {&#10;        this.password = password;&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/pahana_edu/bs/servlet/LoginServlet.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/pahana_edu/bs/servlet/LoginServlet.java" />
              <option name="updatedContent" value="package com.pahana_edu.bs.servlet;&#10;&#10;import com.pahana_edu.bs.model.User;&#10;import jakarta.servlet.ServletException;&#10;import jakarta.servlet.annotation.WebServlet;&#10;import jakarta.servlet.http.HttpServlet;&#10;import jakarta.servlet.http.HttpServletRequest;&#10;import jakarta.servlet.http.HttpServletResponse;&#10;import jakarta.servlet.http.HttpSession;&#10;&#10;import java.io.IOException;&#10;&#10;@WebServlet(name = &quot;loginServlet&quot;, value = &quot;/login&quot;)&#10;public class LoginServlet extends HttpServlet {&#10;    // In a real application, these would come from a database&#10;    private static final String ADMIN_USERNAME = &quot;admin&quot;;&#10;    private static final String ADMIN_PASSWORD = &quot;admin123&quot;;&#10;&#10;    @Override&#10;    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {&#10;        String username = request.getParameter(&quot;username&quot;);&#10;        String password = request.getParameter(&quot;password&quot;);&#10;&#10;        if (ADMIN_USERNAME.equals(username) &amp;&amp; ADMIN_PASSWORD.equals(password)) {&#10;            // Create user object&#10;            User user = new User(username, password);&#10;            &#10;            // Create session and add user&#10;            HttpSession session = request.getSession();&#10;            session.setAttribute(&quot;user&quot;, user);&#10;            session.setMaxInactiveInterval(30 * 60); // 30 minutes session timeout&#10;            &#10;            // Redirect to dashboard&#10;            response.sendRedirect(&quot;AdminDashboardServlet&quot;);&#10;        } else {&#10;            // Set error message and forward back to login page&#10;            request.setAttribute(&quot;error&quot;, &quot;Invalid username or password&quot;);&#10;            request.getRequestDispatcher(&quot;login.jsp&quot;).forward(request, response);&#10;        }&#10;    }&#10;&#10;    @Override&#10;    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {&#10;        request.getRequestDispatcher(&quot;login.jsp&quot;).forward(request, response);&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/pahana_edu/bs/servlet/LogoutServlet.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/pahana_edu/bs/servlet/LogoutServlet.java" />
              <option name="updatedContent" value="package com.pahana_edu.bs.servlet;&#10;&#10;import jakarta.servlet.ServletException;&#10;import jakarta.servlet.annotation.WebServlet;&#10;import jakarta.servlet.http.HttpServlet;&#10;import jakarta.servlet.http.HttpServletRequest;&#10;import jakarta.servlet.http.HttpServletResponse;&#10;import jakarta.servlet.http.HttpSession;&#10;import java.io.IOException;&#10;&#10;@WebServlet(name = &quot;logoutServlet&quot;, value = &quot;/logout&quot;)&#10;public class LogoutServlet extends HttpServlet {&#10;    @Override&#10;    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {&#10;        HttpSession session = request.getSession(false);&#10;        if (session != null) {&#10;            session.invalidate();&#10;        }&#10;        response.sendRedirect(&quot;login.jsp&quot;);&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/pahana_edu/mypro/model/Bill.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/pahana_edu/mypro/model/Bill.java" />
              <option name="updatedContent" value="package com.pahana_edu.mypro.model;&#10;&#10;import java.math.BigDecimal;&#10;import java.sql.Timestamp;&#10;import java.util.List;&#10;&#10;public class Bill {&#10;    private Long id;&#10;    private String billNumber;&#10;    private Long customerId;&#10;    private String customerName; // For display purposes&#10;    private BigDecimal subtotal;&#10;    private BigDecimal discount;&#10;    private BigDecimal totalAmount;&#10;    private String paymentStatus;&#10;    private String paymentMethod;&#10;    private String notes;&#10;    private Timestamp createdAt;&#10;    private List&lt;BillItem&gt; items;&#10;&#10;    // Constructors&#10;    public Bill() {}&#10;&#10;    public Bill(Long id, String billNumber, Long customerId, BigDecimal subtotal, &#10;                BigDecimal discount, BigDecimal totalAmount, String paymentStatus, &#10;                String paymentMethod, String notes, Timestamp createdAt) {&#10;        this.id = id;&#10;        this.billNumber = billNumber;&#10;        this.customerId = customerId;&#10;        this.subtotal = subtotal;&#10;        this.discount = discount;&#10;        this.totalAmount = totalAmount;&#10;        this.paymentStatus = paymentStatus;&#10;        this.paymentMethod = paymentMethod;&#10;        this.notes = notes;&#10;        this.createdAt = createdAt;&#10;    }&#10;&#10;    // Getters and Setters&#10;    public Long getId() { return id; }&#10;    public void setId(Long id) { this.id = id; }&#10;&#10;    public String getBillNumber() { return billNumber; }&#10;    public void setBillNumber(String billNumber) { this.billNumber = billNumber; }&#10;&#10;    public Long getCustomerId() { return customerId; }&#10;    public void setCustomerId(Long customerId) { this.customerId = customerId; }&#10;&#10;    public String getCustomerName() { return customerName; }&#10;    public void setCustomerName(String customerName) { this.customerName = customerName; }&#10;&#10;    public BigDecimal getSubtotal() { return subtotal; }&#10;    public void setSubtotal(BigDecimal subtotal) { this.subtotal = subtotal; }&#10;&#10;    public BigDecimal getDiscount() { return discount; }&#10;    public void setDiscount(BigDecimal discount) { this.discount = discount; }&#10;&#10;    public BigDecimal getTotalAmount() { return totalAmount; }&#10;    public void setTotalAmount(BigDecimal totalAmount) { this.totalAmount = totalAmount; }&#10;&#10;    public String getPaymentStatus() { return paymentStatus; }&#10;    public void setPaymentStatus(String paymentStatus) { this.paymentStatus = paymentStatus; }&#10;&#10;    public String getPaymentMethod() { return paymentMethod; }&#10;    public void setPaymentMethod(String paymentMethod) { this.paymentMethod = paymentMethod; }&#10;&#10;    public String getNotes() { return notes; }&#10;    public void setNotes(String notes) { this.notes = notes; }&#10;&#10;    public Timestamp getCreatedAt() { return createdAt; }&#10;    public void setCreatedAt(Timestamp createdAt) { this.createdAt = createdAt; }&#10;&#10;    public List&lt;BillItem&gt; getItems() { return items; }&#10;    public void setItems(List&lt;BillItem&gt; items) { this.items = items; }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/pahana_edu/mypro/model/BillItem.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/pahana_edu/mypro/model/BillItem.java" />
              <option name="updatedContent" value="package com.pahana_edu.mypro.model;&#10;&#10;import java.math.BigDecimal;&#10;&#10;public class BillItem {&#10;    private Long id;&#10;    private Long billId;&#10;    private Long bookId;&#10;    private String bookTitle; // For display purposes&#10;    private int quantity;&#10;    private BigDecimal unitPrice;&#10;    private BigDecimal subtotal;&#10;&#10;    // Constructors&#10;    public BillItem() {}&#10;&#10;    public BillItem(Long id, Long billId, Long bookId, int quantity, &#10;                   BigDecimal unitPrice, BigDecimal subtotal) {&#10;        this.id = id;&#10;        this.billId = billId;&#10;        this.bookId = bookId;&#10;        this.quantity = quantity;&#10;        this.unitPrice = unitPrice;&#10;        this.subtotal = subtotal;&#10;    }&#10;&#10;    // Getters and Setters&#10;    public Long getId() { return id; }&#10;    public void setId(Long id) { this.id = id; }&#10;&#10;    public Long getBillId() { return billId; }&#10;    public void setBillId(Long billId) { this.billId = billId; }&#10;&#10;    public Long getBookId() { return bookId; }&#10;    public void setBookId(Long bookId) { this.bookId = bookId; }&#10;&#10;    public String getBookTitle() { return bookTitle; }&#10;    public void setBookTitle(String bookTitle) { this.bookTitle = bookTitle; }&#10;&#10;    public int getQuantity() { return quantity; }&#10;    public void setQuantity(int quantity) { this.quantity = quantity; }&#10;&#10;    public BigDecimal getUnitPrice() { return unitPrice; }&#10;    public void setUnitPrice(BigDecimal unitPrice) { this.unitPrice = unitPrice; }&#10;&#10;    public BigDecimal getSubtotal() { return subtotal; }&#10;    public void setSubtotal(BigDecimal subtotal) { this.subtotal = subtotal; }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/pahana_edu/mypro/servlet/BillServlet.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/pahana_edu/mypro/servlet/BillServlet.java" />
              <option name="updatedContent" value="package com.pahana_edu.mypro.servlet;&#10;&#10;import com.pahana_edu.mypro.DAO.BillDAO;&#10;import com.pahana_edu.mypro.model.Bill;&#10;import com.pahana_edu.mypro.model.BillItem;&#10;&#10;import javax.servlet.ServletException;&#10;import javax.servlet.annotation.WebServlet;&#10;import javax.servlet.http.HttpServlet;&#10;import javax.servlet.http.HttpServletRequest;&#10;import javax.servlet.http.HttpServletResponse;&#10;import java.io.IOException;&#10;import java.sql.SQLException;&#10;import java.text.ParseException;&#10;import java.text.SimpleDateFormat;&#10;import java.util.ArrayList;&#10;import java.util.Date;&#10;import java.util.List;&#10;&#10;@WebServlet(&quot;/BillServlet&quot;)&#10;public class BillServlet extends HttpServlet {&#10;    private BillDAO billDAO;&#10;&#10;    public void init() {&#10;        billDAO = new BillDAO();&#10;    }&#10;&#10;    protected void doPost(HttpServletRequest request, HttpServletResponse response) &#10;            throws ServletException, IOException {&#10;        String action = request.getParameter(&quot;action&quot;);&#10;        &#10;        try {&#10;            if (&quot;create&quot;.equals(action)) {&#10;                createBill(request, response);&#10;            } else if (&quot;updatePayment&quot;.equals(action)) {&#10;                updatePaymentStatus(request, response);&#10;            }&#10;        } catch (SQLException ex) {&#10;            request.setAttribute(&quot;errorMessage&quot;, &quot;Database error: &quot; + ex.getMessage());&#10;            request.getRequestDispatcher(&quot;Bill.jsp&quot;).forward(request, response);&#10;        }&#10;    }&#10;&#10;    protected void doGet(HttpServletRequest request, HttpServletResponse response) &#10;            throws ServletException, IOException {&#10;        try {&#10;            // Handle filters&#10;            String paymentStatus = request.getParameter(&quot;paymentStatus&quot;);&#10;            String paymentMethod = request.getParameter(&quot;paymentMethod&quot;);&#10;            String fromDate = request.getParameter(&quot;fromDate&quot;);&#10;            String toDate = request.getParameter(&quot;toDate&quot;);&#10;&#10;            List&lt;Bill&gt; bills;&#10;            if (fromDate != null &amp;&amp; !fromDate.isEmpty() &amp;&amp; toDate != null &amp;&amp; !toDate.isEmpty()) {&#10;                SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);&#10;                Date start = sdf.parse(fromDate);&#10;                Date end = sdf.parse(toDate);&#10;                bills = billDAO.getBillsByDateRange(start, end);&#10;            } else {&#10;                bills = billDAO.getAllBills();&#10;            }&#10;&#10;            // Filter by payment status if specified&#10;            if (paymentStatus != null &amp;&amp; !paymentStatus.isEmpty()) {&#10;                bills = filterBillsByStatus(bills, paymentStatus);&#10;            }&#10;&#10;            // Filter by payment method if specified&#10;            if (paymentMethod != null &amp;&amp; !paymentMethod.isEmpty()) {&#10;                bills = filterBillsByMethod(bills, paymentMethod);&#10;            }&#10;&#10;            // Calculate summary statistics&#10;            int totalBills = bills.size();&#10;            int paidBills = (int) bills.stream()&#10;                    .filter(b -&gt; &quot;PAID&quot;.equals(b.getPaymentStatus()))&#10;                    .count();&#10;            int unpaidBills = (int) bills.stream()&#10;                    .filter(b -&gt; &quot;UNPAID&quot;.equals(b.getPaymentStatus()))&#10;                    .count();&#10;            double totalSales = bills.stream()&#10;                    .mapToDouble(Bill::getTotalAmount)&#10;                    .sum();&#10;&#10;            request.setAttribute(&quot;bills&quot;, bills);&#10;            request.setAttribute(&quot;totalBills&quot;, totalBills);&#10;            request.setAttribute(&quot;paidBills&quot;, paidBills);&#10;            request.setAttribute(&quot;unpaidBills&quot;, unpaidBills);&#10;            request.setAttribute(&quot;totalSales&quot;, totalSales);&#10;&#10;            request.getRequestDispatcher(&quot;Report.jsp&quot;).forward(request, response);&#10;        } catch (SQLException | ParseException ex) {&#10;            request.setAttribute(&quot;errorMessage&quot;, &quot;Error: &quot; + ex.getMessage());&#10;            request.getRequestDispatcher(&quot;Report.jsp&quot;).forward(request, response);&#10;        }&#10;    }&#10;&#10;    private void createBill(HttpServletRequest request, HttpServletResponse response) &#10;            throws SQLException, ServletException, IOException {&#10;        // Create new bill&#10;        Bill bill = new Bill();&#10;        bill.setCustomerId(Integer.parseInt(request.getParameter(&quot;customerId&quot;)));&#10;        bill.setCustomerName(request.getParameter(&quot;customerName&quot;));&#10;        bill.setBillNumber(generateBillNumber());&#10;        bill.setBillDate(new Date());&#10;        bill.setPaymentStatus(request.getParameter(&quot;paymentStatus&quot;));&#10;        bill.setPaymentMethod(request.getParameter(&quot;paymentMethod&quot;));&#10;&#10;        // Process bill items&#10;        String[] bookIds = request.getParameterValues(&quot;bookId&quot;);&#10;        String[] quantities = request.getParameterValues(&quot;quantity&quot;);&#10;        String[] prices = request.getParameterValues(&quot;price&quot;);&#10;        &#10;        List&lt;BillItem&gt; items = new ArrayList&lt;&gt;();&#10;        double totalAmount = 0;&#10;&#10;        for (int i = 0; i &lt; bookIds.length; i++) {&#10;            BillItem item = new BillItem();&#10;            item.setBookId(Integer.parseInt(bookIds[i]));&#10;            item.setQuantity(Integer.parseInt(quantities[i]));&#10;            item.setUnitPrice(Double.parseDouble(prices[i]));&#10;            item.setSubtotal(item.getQuantity() * item.getUnitPrice());&#10;            totalAmount += item.getSubtotal();&#10;            items.add(item);&#10;        }&#10;&#10;        bill.setTotalAmount(totalAmount);&#10;        bill.setItems(items);&#10;&#10;        // Save bill and items&#10;        int billId = billDAO.createBill(bill);&#10;        if (billId != -1) {&#10;            billDAO.createBillItems(items, billId);&#10;            request.setAttribute(&quot;successMessage&quot;, &quot;Bill created successfully!&quot;);&#10;        } else {&#10;            request.setAttribute(&quot;errorMessage&quot;, &quot;Failed to create bill&quot;);&#10;        }&#10;&#10;        response.sendRedirect(&quot;BillServlet&quot;);&#10;    }&#10;&#10;    private void updatePaymentStatus(HttpServletRequest request, HttpServletResponse response) &#10;            throws SQLException, ServletException, IOException {&#10;        int billId = Integer.parseInt(request.getParameter(&quot;billId&quot;));&#10;        String status = request.getParameter(&quot;paymentStatus&quot;);&#10;        String method = request.getParameter(&quot;paymentMethod&quot;);&#10;        &#10;        billDAO.updatePaymentStatus(billId, status, method);&#10;        request.setAttribute(&quot;successMessage&quot;, &quot;Payment status updated successfully!&quot;);&#10;        response.sendRedirect(&quot;BillServlet&quot;);&#10;    }&#10;&#10;    private List&lt;Bill&gt; filterBillsByStatus(List&lt;Bill&gt; bills, String status) {&#10;        List&lt;Bill&gt; filtered = new ArrayList&lt;&gt;();&#10;        for (Bill bill : bills) {&#10;            if (status.equals(bill.getPaymentStatus())) {&#10;                filtered.add(bill);&#10;            }&#10;        }&#10;        return filtered;&#10;    }&#10;&#10;    private List&lt;Bill&gt; filterBillsByMethod(List&lt;Bill&gt; bills, String method) {&#10;        List&lt;Bill&gt; filtered = new ArrayList&lt;&gt;();&#10;        for (Bill bill : bills) {&#10;            if (method.equals(bill.getPaymentMethod())) {&#10;                filtered.add(bill);&#10;            }&#10;        }&#10;        return filtered;&#10;    }&#10;&#10;    private String generateBillNumber() {&#10;        return &quot;BILL-&quot; + System.currentTimeMillis();&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/pahana_edu/mypro/servlet/CreateBillServlet.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/pahana_edu/mypro/servlet/CreateBillServlet.java" />
              <option name="originalContent" value="package com.pahana_edu.mypro.servlet;&#10;&#10;import com.pahana_edu.mypro.DAO.BillDAO;&#10;import com.pahana_edu.mypro.DAO.BookDAO;&#10;import com.pahana_edu.mypro.DAO.CustomerDAO;&#10;import com.pahana_edu.mypro.model.Bill;&#10;import com.pahana_edu.mypro.model.BillItem;&#10;import com.pahana_edu.mypro.model.Book;&#10;import com.pahana_edu.mypro.model.Customer;&#10;&#10;import javax.servlet.ServletException;&#10;import javax.servlet.annotation.WebServlet;&#10;import javax.servlet.http.HttpServlet;&#10;import javax.servlet.http.HttpServletRequest;&#10;import javax.servlet.http.HttpServletResponse;&#10;import java.io.IOException;&#10;import java.math.BigDecimal;&#10;import java.sql.SQLException;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;import com.google.gson.Gson;&#10;import com.google.gson.JsonObject;&#10;&#10;@WebServlet(&quot;/CreateBillServlet&quot;)&#10;public class CreateBillServlet extends HttpServlet {&#10;    private BillDAO billDAO;&#10;    private BookDAO bookDAO;&#10;    private CustomerDAO customerDAO;&#10;    private Gson gson;&#10;&#10;    @Override&#10;    public void init() throws ServletException {&#10;        try {&#10;            billDAO = new BillDAO();&#10;            bookDAO = new BookDAO();&#10;            customerDAO = new CustomerDAO();&#10;            gson = new Gson();&#10;        } catch (SQLException e) {&#10;            throw new ServletException(&quot;Error initializing DAOs&quot;, e);&#10;        }&#10;    }&#10;&#10;    @Override&#10;    protected void doGet(HttpServletRequest request, HttpServletResponse response)&#10;            throws ServletException, IOException {&#10;        try {&#10;            List&lt;Book&gt; books = bookDAO.getAllBooks();&#10;            List&lt;Customer&gt; customers = customerDAO.getAllCustomers();&#10;            &#10;            request.setAttribute(&quot;books&quot;, books);&#10;            request.setAttribute(&quot;customers&quot;, customers);&#10;            request.getRequestDispatcher(&quot;/Bill.jsp&quot;).forward(request, response);&#10;        } catch (SQLException e) {&#10;            throw new ServletException(&quot;Error loading billing page&quot;, e);&#10;        }&#10;    }&#10;&#10;    @Override&#10;    protected void doPost(HttpServletRequest request, HttpServletResponse response)&#10;            throws ServletException, IOException {&#10;        try {&#10;            // Extract bill data&#10;            Long customerId = Long.parseLong(request.getParameter(&quot;customerId&quot;));&#10;            BigDecimal subtotal = new BigDecimal(request.getParameter(&quot;subtotal&quot;));&#10;            BigDecimal discount = new BigDecimal(request.getParameter(&quot;discount&quot;));&#10;            BigDecimal totalAmount = new BigDecimal(request.getParameter(&quot;total&quot;));&#10;            String paymentStatus = request.getParameter(&quot;paymentStatus&quot;);&#10;            String paymentMethod = request.getParameter(&quot;paymentMethod&quot;);&#10;            String notes = request.getParameter(&quot;notes&quot;);&#10;&#10;            // Create bill object&#10;            Bill bill = new Bill();&#10;            bill.setCustomerId(customerId);&#10;            bill.setSubtotal(subtotal);&#10;            bill.setDiscount(discount);&#10;            bill.setTotalAmount(totalAmount);&#10;            bill.setPaymentStatus(paymentStatus);&#10;            bill.setPaymentMethod(paymentMethod);&#10;            bill.setNotes(notes);&#10;&#10;            // Process bill items&#10;            String[] bookIds = request.getParameterValues(&quot;bookId&quot;);&#10;            String[] quantities = request.getParameterValues(&quot;quantity&quot;);&#10;            List&lt;BillItem&gt; items = new ArrayList&lt;&gt;();&#10;&#10;            for (int i = 0; i &lt; bookIds.length; i++) {&#10;                Long bookId = Long.parseLong(bookIds[i]);&#10;                int quantity = Integer.parseInt(quantities[i]);&#10;                Book book = bookDAO.getBookById(bookId);&#10;&#10;                BillItem item = new BillItem();&#10;                item.setBookId(bookId);&#10;                item.setQuantity(quantity);&#10;                item.setUnitPrice(book.getPrice());&#10;                item.setSubtotal(book.getPrice().multiply(new BigDecimal(quantity)));&#10;                items.add(item);&#10;            }&#10;&#10;            bill.setItems(items);&#10;&#10;            // Save the bill&#10;            Bill savedBill = billDAO.createBill(bill);&#10;&#10;            // Send success response&#10;            JsonObject jsonResponse = new JsonObject();&#10;            jsonResponse.addProperty(&quot;success&quot;, true);&#10;            jsonResponse.addProperty(&quot;billId&quot;, savedBill.getId());&#10;            jsonResponse.addProperty(&quot;billNumber&quot;, savedBill.getBillNumber());&#10;            jsonResponse.addProperty(&quot;message&quot;, &quot;Bill created successfully!&quot;);&#10;&#10;            response.setContentType(&quot;application/json&quot;);&#10;            response.getWriter().write(gson.toJson(jsonResponse));&#10;&#10;        } catch (SQLException e) {&#10;            response.setStatus(HttpServletResponse.SC_INTERNAL_SERVER_ERROR);&#10;            JsonObject errorResponse = new JsonObject();&#10;            errorResponse.addProperty(&quot;success&quot;, false);&#10;            errorResponse.addProperty(&quot;message&quot;, &quot;Error creating bill: &quot; + e.getMessage());&#10;            response.getWriter().write(gson.toJson(errorResponse));&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.pahana_edu.mypro.servlet;&#10;&#10;import com.pahana_edu.mypro.DAO.BillDAO;&#10;import com.pahana_edu.mypro.DAO.BookDAO;&#10;import com.pahana_edu.mypro.DAO.CustomerDAO;&#10;import com.pahana_edu.mypro.model.Bill;&#10;import com.pahana_edu.mypro.model.BillItem;&#10;import com.pahana_edu.mypro.model.Book;&#10;import com.pahana_edu.mypro.model.Customer;&#10;&#10;import javax.servlet.ServletException;&#10;import javax.servlet.annotation.WebServlet;&#10;import javax.servlet.http.HttpServlet;&#10;import javax.servlet.http.HttpServletRequest;&#10;import javax.servlet.http.HttpServletResponse;&#10;import java.io.IOException;&#10;import java.math.BigDecimal;&#10;import java.sql.SQLException;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;&#10;@WebServlet(&quot;/CreateBillServlet&quot;)&#10;public class CreateBillServlet extends HttpServlet {&#10;    private BillDAO billDAO;&#10;    private BookDAO bookDAO;&#10;    private CustomerDAO customerDAO;&#10;&#10;    @Override&#10;    public void init() throws ServletException {&#10;        try {&#10;            billDAO = new BillDAO();&#10;            bookDAO = new BookDAO();&#10;            customerDAO = new CustomerDAO();&#10;        } catch (SQLException e) {&#10;            throw new ServletException(&quot;Error initializing DAOs&quot;, e);&#10;        }&#10;    }&#10;&#10;    @Override&#10;    protected void doGet(HttpServletRequest request, HttpServletResponse response)&#10;            throws ServletException, IOException {&#10;        try {&#10;            List&lt;Book&gt; books = bookDAO.getAllBooks();&#10;            List&lt;Customer&gt; customers = customerDAO.getAllCustomers();&#10;            &#10;            request.setAttribute(&quot;books&quot;, books);&#10;            request.setAttribute(&quot;customers&quot;, customers);&#10;            request.getRequestDispatcher(&quot;/Bill.jsp&quot;).forward(request, response);&#10;        } catch (SQLException e) {&#10;            throw new ServletException(&quot;Error loading billing page&quot;, e);&#10;        }&#10;    }&#10;&#10;    @Override&#10;    protected void doPost(HttpServletRequest request, HttpServletResponse response)&#10;            throws ServletException, IOException {&#10;        try {&#10;            // Extract bill data&#10;            Long customerId = Long.parseLong(request.getParameter(&quot;customerId&quot;));&#10;            BigDecimal subtotal = new BigDecimal(request.getParameter(&quot;subtotal&quot;));&#10;            BigDecimal discount = new BigDecimal(request.getParameter(&quot;discount&quot;));&#10;            BigDecimal totalAmount = new BigDecimal(request.getParameter(&quot;total&quot;));&#10;            String paymentStatus = request.getParameter(&quot;paymentStatus&quot;);&#10;            String paymentMethod = request.getParameter(&quot;paymentMethod&quot;);&#10;            String notes = request.getParameter(&quot;notes&quot;);&#10;&#10;            // Create bill object&#10;            Bill bill = new Bill();&#10;            bill.setCustomerId(customerId);&#10;            bill.setSubtotal(subtotal);&#10;            bill.setDiscount(discount);&#10;            bill.setTotalAmount(totalAmount);&#10;            bill.setPaymentStatus(paymentStatus);&#10;            bill.setPaymentMethod(paymentMethod);&#10;            bill.setNotes(notes);&#10;&#10;            // Process bill items&#10;            String[] bookIds = request.getParameterValues(&quot;bookId&quot;);&#10;            String[] quantities = request.getParameterValues(&quot;quantity&quot;);&#10;            List&lt;BillItem&gt; items = new ArrayList&lt;&gt;();&#10;&#10;            for (int i = 0; i &lt; bookIds.length; i++) {&#10;                Long bookId = Long.parseLong(bookIds[i]);&#10;                int quantity = Integer.parseInt(quantities[i]);&#10;                Book book = bookDAO.getBookById(bookId);&#10;&#10;                BillItem item = new BillItem();&#10;                item.setBookId(bookId);&#10;                item.setQuantity(quantity);&#10;                item.setUnitPrice(book.getPrice());&#10;                item.setSubtotal(book.getPrice().multiply(new BigDecimal(quantity)));&#10;                items.add(item);&#10;            }&#10;&#10;            bill.setItems(items);&#10;&#10;            // Save the bill&#10;            Bill savedBill = billDAO.createBill(bill);&#10;&#10;            // Send success response&#10;            response.setContentType(&quot;application/json&quot;);&#10;            response.getWriter().write(&quot;{\&quot;success\&quot;:true,\&quot;billId\&quot;:&quot; + savedBill.getId() + &quot;,\&quot;billNumber\&quot;:\&quot;&quot; + savedBill.getBillNumber() + &quot;\&quot;,\&quot;message\&quot;:\&quot;Bill created successfully!\&quot;}&quot;);&#10;&#10;        } catch (SQLException e) {&#10;            response.setStatus(HttpServletResponse.SC_INTERNAL_SERVER_ERROR);&#10;            response.getWriter().write(&quot;{\&quot;success\&quot;:false,\&quot;message\&quot;:\&quot;Error creating bill: &quot; + e.getMessage() + &quot;\&quot;}&quot;);&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/resources/billing_schema.sql">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/resources/billing_schema.sql" />
              <option name="originalContent" value="&#10;" />
              <option name="updatedContent" value="-- Bills table&#10;CREATE TABLE bills (&#10;    bill_id BIGINT PRIMARY KEY AUTO_INCREMENT,&#10;    bill_number VARCHAR(50) UNIQUE NOT NULL,&#10;    customer_id BIGINT NOT NULL,&#10;    bill_date DATETIME NOT NULL,&#10;    subtotal DECIMAL(10,2) NOT NULL,&#10;    discount DECIMAL(10,2) DEFAULT 0.00,&#10;    total_amount DECIMAL(10,2) NOT NULL,&#10;    payment_status ENUM('PAID', 'UNPAID', 'PARTIAL') NOT NULL DEFAULT 'UNPAID',&#10;    payment_method ENUM('CASH', 'CARD', 'ONLINE', 'CHEQUE') NOT NULL DEFAULT 'CASH',&#10;    notes TEXT,&#10;    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,&#10;    FOREIGN KEY (customer_id) REFERENCES customers(customer_id)&#10;);&#10;&#10;-- Bill Items table (for items in each bill)&#10;CREATE TABLE bill_items (&#10;    item_id BIGINT PRIMARY KEY AUTO_INCREMENT,&#10;    bill_id BIGINT NOT NULL,&#10;    book_id BIGINT NOT NULL,&#10;    quantity INT NOT NULL,&#10;    unit_price DECIMAL(10,2) NOT NULL,&#10;    subtotal DECIMAL(10,2) NOT NULL,&#10;    FOREIGN KEY (bill_id) REFERENCES bills(bill_id),&#10;    FOREIGN KEY (book_id) REFERENCES books(book_id)&#10;);" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/webapp/Bill.jsp">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/webapp/Bill.jsp" />
              <option name="originalContent" value="ok now &lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;&#10;&lt;%@ taglib uri=&quot;http://java.sun.com/jsp/jstl/core&quot; prefix=&quot;c&quot; %&gt;&#10;&lt;!DOCTYPE html&gt;&#10;&lt;html lang=&quot;en&quot;&gt;&#10;&lt;head&gt;&#10;    &lt;meta charset=&quot;UTF-8&quot;&gt;&#10;    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;&#10;    &lt;title&gt;Billing - PahanEdu Bookshop&lt;/title&gt;&#10;    &lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;&#10;    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css&quot;&gt;&#10;    &lt;style&gt;&#10;        /* Scrollbar styles */&#10;        ::-webkit-scrollbar { width: 8px; }&#10;        ::-webkit-scrollbar-track { background: #f1f1f1; }&#10;        ::-webkit-scrollbar-thumb { background: #888; border-radius: 4px; }&#10;        ::-webkit-scrollbar-thumb:hover { background: #555; }&#10;&#10;        /* Notification styles */&#10;        .notification { animation: slideIn 0.3s ease-out, fadeOut 0.5s ease 3s forwards; }&#10;        @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }&#10;        @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }&#10;        .hidden { display: none; }&#10;&#10;        /* Print styles */&#10;        @media print {&#10;            body * { visibility: hidden; }&#10;            #printable-bill, #printable-bill * { visibility: visible; }&#10;            #printable-bill { position: absolute; left: 0; top: 0; width: 100%; }&#10;            .no-print { display: none !important; }&#10;        }&#10;    &lt;/style&gt;&#10;&lt;/head&gt;&#10;&lt;body class=&quot;bg-gray-50 font-sans&quot;&gt;&#10;&#10;&lt;!-- Notification Area --&gt;&#10;&lt;div id=&quot;notification-area&quot; class=&quot;fixed top-4 right-4 z-50 space-y-2&quot;&gt;&#10;    &lt;c:if test=&quot;${not empty successMessage}&quot;&gt;&#10;        &lt;div class=&quot;notification px-4 py-3 rounded-md shadow-md flex items-center bg-green-100 text-green-800&quot;&gt;&#10;            &lt;i class=&quot;fas fa-check-circle mr-2&quot;&gt;&lt;/i&gt;&#10;                ${successMessage}&#10;        &lt;/div&gt;&#10;    &lt;/c:if&gt;&#10;    &lt;c:if test=&quot;${not empty errorMessage}&quot;&gt;&#10;        &lt;div class=&quot;notification px-4 py-3 rounded-md shadow-md flex items-center bg-red-100 text-red-800&quot;&gt;&#10;            &lt;i class=&quot;fas fa-exclamation-circle mr-2&quot;&gt;&lt;/i&gt;&#10;                ${errorMessage}&#10;        &lt;/div&gt;&#10;    &lt;/c:if&gt;&#10;&lt;/div&gt;&#10;&#10;&lt;!-- Sidebar --&gt;&#10;&lt;div class=&quot;fixed inset-y-0 left-0 transform -translate-x-full md:translate-x-0 transition duration-200 ease-in-out z-40 w-64 bg-indigo-800 text-white shadow-lg&quot;&gt;&#10;    &lt;div class=&quot;flex items-center justify-center h-16 px-4 border-b border-indigo-700&quot;&gt;&#10;        &lt;div class=&quot;flex items-center space-x-2&quot;&gt;&#10;            &lt;i class=&quot;fas fa-book-open text-2xl text-indigo-300&quot;&gt;&lt;/i&gt;&#10;            &lt;span class=&quot;text-xl font-bold&quot;&gt;PahanEdu&lt;/span&gt;&#10;        &lt;/div&gt;&#10;    &lt;/div&gt;&#10;    &lt;nav class=&quot;mt-6&quot;&gt;&#10;        &lt;div class=&quot;px-4 space-y-1&quot;&gt;&#10;            &lt;a href=&quot;AdminDashboardServlet&quot; class=&quot;flex items-center px-4 py-3 text-indigo-200 hover:text-white hover:bg-indigo-700 rounded-lg&quot;&gt;&#10;                &lt;i class=&quot;fas fa-tachometer-alt mr-3&quot;&gt;&lt;/i&gt; Dashboard&#10;            &lt;/a&gt;&#10;            &lt;a href=&quot;BookServlet&quot; class=&quot;flex items-center px-4 py-3 text-indigo-200 hover:text-white hover:bg-indigo-700 rounded-lg&quot;&gt;&#10;                &lt;i class=&quot;fas fa-book mr-3&quot;&gt;&lt;/i&gt; Books&#10;            &lt;/a&gt;&#10;            &lt;a href=&quot;CustomerServlet&quot; class=&quot;flex items-center px-4 py-3 text-indigo-200 hover:text-white hover:bg-indigo-700 rounded-lg&quot;&gt;&#10;                &lt;i class=&quot;fas fa-users mr-3&quot;&gt;&lt;/i&gt; Customers&#10;            &lt;/a&gt;&#10;            &lt;a href=&quot;CreateBillServlet&quot; class=&quot;flex items-center px-4 py-3 text-white bg-indigo-900 rounded-lg&quot;&gt;&#10;                &lt;i class=&quot;fa-solid fa-money-bill mr-3&quot;&gt;&lt;/i&gt; Create Bill&#10;            &lt;/a&gt;&#10;            &lt;a href=&quot;BillServlet&quot; class=&quot;flex items-center px-4 py-3 text-indigo-200 hover:text-white hover:bg-indigo-700 rounded-lg&quot;&gt;&#10;                &lt;i class=&quot;fas fa-chart-line mr-3&quot;&gt;&lt;/i&gt; Reports&#10;            &lt;/a&gt;&#10;&#10;        &lt;/div&gt;&#10;    &lt;/nav&gt;&#10;&lt;/div&gt;&#10;&#10;&lt;!-- Mobile sidebar toggle --&gt;&#10;&lt;div class=&quot;md:hidden fixed top-4 left-4 z-40&quot;&gt;&#10;    &lt;button id=&quot;sidebar-toggle&quot; class=&quot;p-2 rounded-md bg-indigo-800 text-white focus:outline-none&quot;&gt;&#10;        &lt;i class=&quot;fas fa-bars&quot;&gt;&lt;/i&gt;&#10;    &lt;/button&gt;&#10;&lt;/div&gt;&#10;&#10;&lt;!-- Main Content --&gt;&#10;&lt;div class=&quot;md:ml-64 min-h-screen&quot;&gt;&#10;    &lt;!-- Header --&gt;&#10;    &lt;header class=&quot;bg-white shadow-sm&quot;&gt;&#10;        &lt;div class=&quot;flex justify-between items-center px-6 py-4&quot;&gt;&#10;            &lt;h1 class=&quot;text-2xl font-semibold text-gray-800 flex items-center&quot;&gt;&#10;                &lt;i class=&quot;fas fa-shopping-cart text-blue-600 mr-3&quot;&gt;&lt;/i&gt; Create New Bill&#10;            &lt;/h1&gt;&#10;        &lt;/div&gt;&#10;    &lt;/header&gt;&#10;&#10;    &lt;!-- Main Content Area --&gt;&#10;    &lt;main class=&quot;p-6&quot;&gt;&#10;        &lt;form id=&quot;billing-form&quot; action=&quot;CreateBillServlet&quot; method=&quot;post&quot;&gt;&#10;            &lt;!-- Hidden fields for form data --&gt;&#10;            &lt;input type=&quot;hidden&quot; name=&quot;customerId&quot; id=&quot;customerId&quot;&gt;&#10;            &lt;input type=&quot;hidden&quot; name=&quot;tax&quot; id=&quot;tax-hidden&quot; value=&quot;0&quot;&gt;&#10;            &lt;input type=&quot;hidden&quot; name=&quot;discount&quot; id=&quot;discount-hidden&quot; value=&quot;0&quot;&gt;&#10;            &lt;input type=&quot;hidden&quot; name=&quot;paymentStatus&quot; id=&quot;payment-status-hidden&quot; value=&quot;UNPAID&quot;&gt;&#10;            &lt;input type=&quot;hidden&quot; name=&quot;paymentMethod&quot; id=&quot;payment-method-hidden&quot; value=&quot;CASH&quot;&gt;&#10;            &lt;input type=&quot;hidden&quot; name=&quot;notes&quot; id=&quot;notes-hidden&quot; value=&quot;&quot;&gt;&#10;&#10;            &lt;!-- Dynamic book data container --&gt;&#10;            &lt;div id=&quot;bill-data&quot;&gt;&#10;                &lt;!-- Will be populated by JavaScript --&gt;&#10;            &lt;/div&gt;&#10;&#10;            &lt;div class=&quot;grid grid-cols-1 lg:grid-cols-3 gap-6&quot;&gt;&#10;                &lt;!-- Customer Info Section --&gt;&#10;                &lt;div class=&quot;bg-white rounded-lg shadow p-6&quot;&gt;&#10;                    &lt;h2 class=&quot;text-lg font-semibold mb-4 flex items-center&quot;&gt;&#10;                        &lt;i class=&quot;fas fa-user-circle mr-2 text-indigo-600&quot;&gt;&lt;/i&gt; Select Customer&#10;                    &lt;/h2&gt;&#10;                    &lt;select id=&quot;book-select&quot; class=&quot;flex-1 border border-gray-300 rounded-lg p-3&quot;&gt;&#10;                        &lt;option value=&quot;&quot;&gt;-- Select Book --&lt;/option&gt;&#10;                        &lt;c:forEach var=&quot;book&quot; items=&quot;${books}&quot;&gt;&#10;                            &lt;option value=&quot;${book.id}&quot;&#10;                                    data-price=&quot;${book.price}&quot;&#10;                                    data-title=&quot;${book.title}&quot;&#10;                                    data-stock=&quot;${book.quantity}&quot;&gt;&#10;                                    ${book.title} - Rs. ${book.price} (Stock: ${book.quantity})&#10;                            &lt;/option&gt;&#10;                        &lt;/c:forEach&gt;&#10;                    &lt;/select&gt;&#10;                    &lt;div class=&quot;bg-gray-50 p-4 rounded-lg border border-gray-200&quot;&gt;&#10;                        &lt;p id=&quot;customer-name&quot; class=&quot;font-medium&quot;&gt;No customer selected&lt;/p&gt;&#10;                        &lt;p id=&quot;customer-phone&quot; class=&quot;text-sm text-gray-500&quot;&gt;&lt;/p&gt;&#10;                        &lt;p id=&quot;customer-email&quot; class=&quot;text-sm text-gray-500&quot;&gt;&lt;/p&gt;&#10;                        &lt;p id=&quot;customer-address&quot; class=&quot;text-sm text-gray-500&quot;&gt;&lt;/p&gt;&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;&#10;                &lt;!-- Book Selection + Bill Table --&gt;&#10;                &lt;div class=&quot;lg:col-span-2 bg-white rounded-lg shadow p-6&quot;&gt;&#10;                    &lt;h2 class=&quot;text-lg font-semibold mb-4 flex items-center&quot;&gt;&#10;                        &lt;i class=&quot;fas fa-book-open mr-2 text-indigo-600&quot;&gt;&lt;/i&gt; Select Books&#10;                    &lt;/h2&gt;&#10;                    &lt;div class=&quot;flex space-x-3 mb-6&quot;&gt;&#10;                        &lt;select id=&quot;book-select&quot; class=&quot;flex-1 border border-gray-300 rounded-lg p-3&quot;&gt;&#10;                            &lt;option value=&quot;&quot;&gt;-- Select Book --&lt;/option&gt;&#10;                            &lt;c:forEach var=&quot;book&quot; items=&quot;${books}&quot;&gt;&#10;                                &lt;option value=&quot;${book.id}&quot;&#10;                                        data-price=&quot;${book.price}&quot;&#10;                                        data-title=&quot;${book.title}&quot;&#10;                                        data-stock=&quot;${book.quantity}&quot;&gt;&#10;                                        ${book.title} - Rs. ${book.price} (Stock: ${book.quantity})&#10;                                &lt;/option&gt;&#10;                            &lt;/c:forEach&gt;&#10;                        &lt;/select&gt;&#10;                        &lt;input type=&quot;number&quot; id=&quot;book-qty&quot; min=&quot;1&quot; value=&quot;1&quot; class=&quot;w-20 border rounded-lg p-3 text-center&quot; placeholder=&quot;Qty&quot;&gt;&#10;                        &lt;button type=&quot;button&quot; id=&quot;add-book&quot; class=&quot;bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700&quot;&gt;&#10;                            &lt;i class=&quot;fas fa-plus&quot;&gt;&lt;/i&gt; Add&#10;                        &lt;/button&gt;&#10;                    &lt;/div&gt;&#10;&#10;                    &lt;!-- Bill Table --&gt;&#10;                    &lt;div class=&quot;overflow-x-auto mb-6&quot;&gt;&#10;                        &lt;table class=&quot;w-full text-left border-collapse border border-gray-200&quot;&gt;&#10;                            &lt;thead&gt;&#10;                            &lt;tr class=&quot;bg-gray-100&quot;&gt;&#10;                                &lt;th class=&quot;p-3 border-b&quot;&gt;Book&lt;/th&gt;&#10;                                &lt;th class=&quot;p-3 border-b text-center&quot;&gt;Qty&lt;/th&gt;&#10;                                &lt;th class=&quot;p-3 border-b text-right&quot;&gt;Unit Price&lt;/th&gt;&#10;                                &lt;th class=&quot;p-3 border-b text-right&quot;&gt;Subtotal&lt;/th&gt;&#10;                                &lt;th class=&quot;p-3 border-b text-center&quot;&gt;Action&lt;/th&gt;&#10;                            &lt;/tr&gt;&#10;                            &lt;/thead&gt;&#10;                            &lt;tbody id=&quot;bill-items&quot;&gt;&#10;                            &lt;!-- This will be populated by JavaScript --&gt;&#10;                            &lt;tr id=&quot;empty-bill&quot;&gt;&#10;                                &lt;td colspan=&quot;5&quot; class=&quot;p-3 text-center text-gray-500 border-b&quot;&gt;&#10;                                    No items added&#10;                                &lt;/td&gt;&#10;                            &lt;/tr&gt;&#10;                            &lt;/tbody&gt;&#10;                        &lt;/table&gt;&#10;                    &lt;/div&gt;&#10;&#10;                    &lt;!-- Hidden fields container --&gt;&#10;                    &lt;div id=&quot;bill-data&quot;&gt;&lt;/div&gt;&#10;&#10;                    &lt;!-- Hidden fields for totals --&gt;&#10;                    &lt;input type=&quot;hidden&quot; name=&quot;subtotal&quot; id=&quot;subtotal-hidden&quot; value=&quot;0&quot;&gt;&#10;                    &lt;input type=&quot;hidden&quot; name=&quot;discount&quot; id=&quot;discount-hidden&quot; value=&quot;0&quot;&gt;&#10;                    &lt;input type=&quot;hidden&quot; name=&quot;total&quot; id=&quot;total-hidden&quot; value=&quot;0&quot;&gt;&#10;&#10;                    &lt;!-- Payment &amp; Totals Section --&gt;&#10;                    &lt;div class=&quot;grid grid-cols-1 md:grid-cols-2 gap-6 mb-6&quot;&gt;&#10;                        &lt;!-- Payment Details --&gt;&#10;                        &lt;div&gt;&#10;                            &lt;h3 class=&quot;font-semibold mb-3&quot;&gt;Payment Details&lt;/h3&gt;&#10;                            &lt;div class=&quot;space-y-3&quot;&gt;&#10;                                &lt;div&gt;&#10;                                    &lt;label class=&quot;block text-sm font-medium mb-1&quot;&gt;Payment Method&lt;/label&gt;&#10;                                    &lt;select id=&quot;payment-method&quot; class=&quot;w-full border border-gray-300 rounded-lg p-2&quot;&gt;&#10;                                        &lt;option value=&quot;CASH&quot;&gt;Cash&lt;/option&gt;&#10;                                        &lt;option value=&quot;CARD&quot;&gt;Card&lt;/option&gt;&#10;                                        &lt;option value=&quot;ONLINE&quot;&gt;Online&lt;/option&gt;&#10;                                        &lt;option value=&quot;CHEQUE&quot;&gt;Cheque&lt;/option&gt;&#10;                                    &lt;/select&gt;&#10;                                &lt;/div&gt;&#10;                                &lt;div&gt;&#10;                                    &lt;label class=&quot;block text-sm font-medium mb-1&quot;&gt;Payment Status&lt;/label&gt;&#10;                                    &lt;select id=&quot;payment-status&quot; class=&quot;w-full border border-gray-300 rounded-lg p-2&quot;&gt;&#10;                                        &lt;option value=&quot;UNPAID&quot;&gt;Unpaid&lt;/option&gt;&#10;                                        &lt;option value=&quot;PAID&quot;&gt;Paid&lt;/option&gt;&#10;                                        &lt;option value=&quot;PARTIAL&quot;&gt;Partial&lt;/option&gt;&#10;                                    &lt;/select&gt;&#10;                                &lt;/div&gt;&#10;                                &lt;div&gt;&#10;                                    &lt;label class=&quot;block text-sm font-medium mb-1&quot;&gt;Discount (%)&lt;/label&gt;&#10;                                    &lt;input type=&quot;number&quot; id=&quot;discount&quot; value=&quot;0&quot; min=&quot;0&quot; max=&quot;100&quot;&#10;                                           class=&quot;w-full border border-gray-300 rounded-lg p-2 text-center&quot;&gt;&#10;                                &lt;/div&gt;&#10;                            &lt;/div&gt;&#10;                        &lt;/div&gt;&#10;&#10;                        &lt;!-- Totals --&gt;&#10;                        &lt;div&gt;&#10;                            &lt;h3 class=&quot;font-semibold mb-3&quot;&gt;Bill Summary&lt;/h3&gt;&#10;                            &lt;div class=&quot;bg-gray-50 p-4 rounded-lg space-y-2&quot;&gt;&#10;                                &lt;div class=&quot;flex justify-between&quot;&gt;&#10;                                    &lt;span&gt;Subtotal:&lt;/span&gt;&#10;                                    &lt;span id=&quot;subtotal&quot;&gt;Rs. 0.00&lt;/span&gt;&#10;                                &lt;/div&gt;&#10;                                &lt;div class=&quot;flex justify-between&quot;&gt;&#10;                                    &lt;span&gt;Discount:&lt;/span&gt;&#10;                                    &lt;span id=&quot;discount-amount&quot;&gt;Rs. 0.00&lt;/span&gt;&#10;                                &lt;/div&gt;&#10;                                &lt;div class=&quot;flex justify-between text-lg font-bold border-t pt-2&quot;&gt;&#10;                                    &lt;span&gt;Total:&lt;/span&gt;&#10;                                    &lt;span id=&quot;total&quot;&gt;Rs. 0.00&lt;/span&gt;&#10;                                &lt;/div&gt;&#10;                            &lt;/div&gt;&#10;                        &lt;/div&gt;&#10;                    &lt;/div&gt;&#10;&#10;                    &lt;!-- Notes Section --&gt;&#10;                    &lt;div class=&quot;mb-6&quot;&gt;&#10;                        &lt;label class=&quot;block text-sm font-medium mb-2&quot;&gt;Notes (Optional)&lt;/label&gt;&#10;                        &lt;textarea id=&quot;notes&quot; rows=&quot;3&quot; placeholder=&quot;Add any additional notes here...&quot;&#10;                                  class=&quot;w-full border border-gray-300 rounded-lg p-3&quot;&gt;&lt;/textarea&gt;&#10;                    &lt;/div&gt;&#10;&#10;                    &lt;!-- Action Buttons --&gt;&#10;                    &lt;div class=&quot;flex justify-between&quot;&gt;&#10;                        &lt;button type=&quot;button&quot; onclick=&quot;clearBill()&quot; class=&quot;bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600&quot;&gt;&#10;                            &lt;i class=&quot;fas fa-times mr-2&quot;&gt;&lt;/i&gt; Clear&#10;                        &lt;/button&gt;&#10;                        &lt;div class=&quot;space-x-3&quot;&gt;&#10;                            &lt;button type=&quot;button&quot; onclick=&quot;window.location.href='BillServlet'&quot; class=&quot;bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700&quot;&gt;&#10;                                &lt;i class=&quot;fas fa-list mr-2&quot;&gt;&lt;/i&gt; View Bills&#10;                            &lt;/button&gt;&#10;                            &lt;button type=&quot;submit&quot; id=&quot;complete-billing&quot; class=&quot;bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700&quot;&gt;&#10;                                &lt;i class=&quot;fas fa-check mr-2&quot;&gt;&lt;/i&gt; Create Bill&#10;                            &lt;/button&gt;&#10;                        &lt;/div&gt;&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;            &lt;/div&gt;&#10;        &lt;/form&gt;&#10;    &lt;/main&gt;&#10;&lt;/div&gt;&#10;&#10;&lt;!-- Scripts --&gt;&#10;&lt;script&gt;&#10;    let billItems = [];&#10;&#10;    // Customer selection handler&#10;    document.getElementById('customer-select').addEventListener('change', function () {&#10;        const selected = this.options[this.selectedIndex];&#10;        document.getElementById('customerId').value = this.value;&#10;        document.getElementById('customer-name').textContent = selected.dataset.name || 'No customer selected';&#10;        document.getElementById('customer-phone').textContent = selected.dataset.phone || '';&#10;        document.getElementById('customer-email').textContent = selected.dataset.email || '';&#10;        document.getElementById('customer-address').textContent = selected.dataset.address || '';&#10;    });&#10;&#10;    // Add book to bill&#10;    document.getElementById('add-book').addEventListener('click', function() {&#10;        const bookSelect = document.getElementById('book-select');&#10;        const qtyInput = document.getElementById('book-qty');&#10;&#10;        if (!bookSelect.value) {&#10;            alert('Please select a book');&#10;            return;&#10;        }&#10;&#10;        const quantity = parseInt(qtyInput.value);&#10;        if (isNaN(quantity) || quantity &lt; 1) {&#10;            alert('Please enter a valid quantity');&#10;            return;&#10;        }&#10;&#10;        const selectedOption = bookSelect.options[bookSelect.selectedIndex];&#10;        const bookId = bookSelect.value;&#10;        const bookTitle = selectedOption.dataset.title;&#10;        const price = parseFloat(selectedOption.dataset.price);&#10;        const stock = parseInt(selectedOption.dataset.stock);&#10;&#10;        // Check if book already exists in bill&#10;        const existingItem = billItems.find(item =&gt; item.bookId === bookId);&#10;        if (existingItem) {&#10;            const newQty = existingItem.qty + quantity;&#10;            if (newQty &gt; stock) {&#10;                alert(`Insufficient stock! Available: ${stock}, Total requested: ${newQty}`);&#10;                return;&#10;            }&#10;            existingItem.qty = newQty;&#10;            existingItem.subtotal = existingItem.qty * price;&#10;        } else {&#10;            if (quantity &gt; stock) {&#10;                alert(`Insufficient stock! Available: ${stock}, Requested: ${quantity}`);&#10;                return;&#10;            }&#10;            billItems.push({&#10;                bookId: bookId,&#10;                bookTitle: bookTitle,&#10;                qty: quantity,&#10;                price: price,&#10;                subtotal: price * quantity&#10;            });&#10;        }&#10;&#10;        // Decrement stock in the dropdown&#10;        selectedOption.dataset.stock = stock - quantity;&#10;        selectedOption.textContent = `${bookTitle} - Rs. ${price} (Stock: ${stock - quantity})`;&#10;&#10;        // Reset form&#10;        bookSelect.value = '';&#10;        qtyInput.value = '1';&#10;        renderBill();&#10;    });&#10;&#10;    // Render bill table&#10;    function renderBill() {&#10;        const tbody = document.getElementById('bill-items');&#10;        const billDataDiv = document.getElementById('bill-data');&#10;&#10;        tbody.innerHTML = '';&#10;        billDataDiv.innerHTML = '';&#10;&#10;        let subtotal = 0;&#10;&#10;        if (billItems.length === 0) {&#10;            tbody.innerHTML = `&#10;            &lt;tr id=&quot;empty-bill&quot;&gt;&#10;                &lt;td colspan=&quot;5&quot; class=&quot;p-3 text-center text-gray-500 border-b&quot;&gt;&#10;                    No items added&#10;                &lt;/td&gt;&#10;            &lt;/tr&gt;&#10;        `;&#10;        } else {&#10;            billItems.forEach((item, index) =&gt; {&#10;                subtotal += item.subtotal;&#10;&#10;                // Add row to table&#10;                tbody.innerHTML += `&#10;                &lt;tr class=&quot;border-b hover:bg-gray-50&quot;&gt;&#10;                    &lt;td class=&quot;p-3&quot;&gt;${item.bookTitle}&lt;/td&gt;&#10;                    &lt;td class=&quot;p-3 text-center&quot;&gt;${item.qty}&lt;/td&gt;&#10;                    &lt;td class=&quot;p-3 text-right&quot;&gt;Rs. ${item.price.toFixed(2)}&lt;/td&gt;&#10;                    &lt;td class=&quot;p-3 text-right&quot;&gt;Rs. ${item.subtotal.toFixed(2)}&lt;/td&gt;&#10;                    &lt;td class=&quot;p-3 text-center&quot;&gt;&#10;                        &lt;button type=&quot;button&quot; onclick=&quot;removeItem(${index})&quot;&#10;                                class=&quot;text-red-600 hover:text-red-800&quot;&gt;&#10;                            &lt;i class=&quot;fas fa-trash&quot;&gt;&lt;/i&gt;&#10;                        &lt;/button&gt;&#10;                    &lt;/td&gt;&#10;                &lt;/tr&gt;&#10;            `;&#10;&#10;                // Add hidden form inputs&#10;                const bookInput = document.createElement('input');&#10;                bookInput.type = 'hidden';&#10;                bookInput.name = 'bookId';&#10;                bookInput.value = item.bookId;&#10;&#10;                const qtyInput = document.createElement('input');&#10;                qtyInput.type = 'hidden';&#10;                qtyInput.name = 'quantity';&#10;                qtyInput.value = item.qty;&#10;&#10;                billDataDiv.appendChild(bookInput);&#10;                billDataDiv.appendChild(qtyInput);&#10;            });&#10;        }&#10;&#10;        updateTotals(subtotal);&#10;    }&#10;&#10;    // Update totals calculation&#10;    function updateTotals(subtotal) {&#10;        const discountPercent = parseFloat(document.getElementById('discount').value) || 0;&#10;        const discountAmount = subtotal * (discountPercent / 100);&#10;        const total = subtotal - discountAmount;&#10;&#10;        document.getElementById('subtotal').textContent = `Rs. ${subtotal.toFixed(2)}`;&#10;        document.getElementById('discount-amount').textContent = `Rs. ${discountAmount.toFixed(2)}`;&#10;        document.getElementById('total').textContent = `Rs. ${total.toFixed(2)}`;&#10;&#10;        // Update hidden fields&#10;        document.getElementById('subtotal-hidden').value = subtotal.toFixed(2);&#10;        document.getElementById('discount-hidden').value = discountAmount.toFixed(2);&#10;        document.getElementById('total-hidden').value = total.toFixed(2);&#10;    }&#10;&#10;    // Remove item from bill&#10;    function removeItem(index) {&#10;        billItems.splice(index, 1);&#10;        renderBill();&#10;    }&#10;&#10;    // Clear entire bill&#10;    function clearBill() {&#10;        if (confirm('Are you sure you want to clear the entire bill?')) {&#10;            billItems = [];&#10;            renderBill();&#10;        }&#10;    }&#10;&#10;    // Submit billing form&#10;    document.getElementById('billing-form').addEventListener('submit', function(event) {&#10;        if (billItems.length === 0) {&#10;            alert('Please add at least one book to the bill.');&#10;            event.preventDefault();&#10;            return;&#10;        }&#10;&#10;        // Pass bill items to the backend&#10;        billItems.forEach(item =&gt; {&#10;            const bookInput = document.createElement('input');&#10;            bookInput.type = 'hidden';&#10;            bookInput.name = 'books';&#10;            bookInput.value = JSON.stringify(item);&#10;&lt;/script&gt;&#10;&#10;&lt;/body&gt;&#10;&lt;/html&gt;" />
              <option name="updatedContent" value="ok now &lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;&#10;&lt;%@ taglib uri=&quot;http://java.sun.com/jsp/jstl/core&quot; prefix=&quot;c&quot; %&gt;&#10;&lt;!DOCTYPE html&gt;&#10;&lt;html lang=&quot;en&quot;&gt;&#10;&lt;head&gt;&#10;    &lt;meta charset=&quot;UTF-8&quot;&gt;&#10;    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;&#10;    &lt;title&gt;Billing - PahanEdu Bookshop&lt;/title&gt;&#10;    &lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;&#10;    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css&quot;&gt;&#10;    &lt;style&gt;&#10;        /* Scrollbar styles */&#10;        ::-webkit-scrollbar { width: 8px; }&#10;        ::-webkit-scrollbar-track { background: #f1f1f1; }&#10;        ::-webkit-scrollbar-thumb { background: #888; border-radius: 4px; }&#10;        ::-webkit-scrollbar-thumb:hover { background: #555; }&#10;&#10;        /* Notification styles */&#10;        .notification { animation: slideIn 0.3s ease-out, fadeOut 0.5s ease 3s forwards; }&#10;        @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }&#10;        @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }&#10;        .hidden { display: none; }&#10;&#10;        /* Print styles */&#10;        @media print {&#10;            body * { visibility: hidden; }&#10;            #printable-bill, #printable-bill * { visibility: visible; }&#10;            #printable-bill { position: absolute; left: 0; top: 0; width: 100%; }&#10;            .no-print { display: none !important; }&#10;        }&#10;    &lt;/style&gt;&#10;&lt;/head&gt;&#10;&lt;body class=&quot;bg-gray-50 font-sans&quot;&gt;&#10;&#10;&lt;!-- Notification Area --&gt;&#10;&lt;div id=&quot;notification-area&quot; class=&quot;fixed top-4 right-4 z-50 space-y-2&quot;&gt;&#10;    &lt;c:if test=&quot;${not empty successMessage}&quot;&gt;&#10;        &lt;div class=&quot;notification px-4 py-3 rounded-md shadow-md flex items-center bg-green-100 text-green-800&quot;&gt;&#10;            &lt;i class=&quot;fas fa-check-circle mr-2&quot;&gt;&lt;/i&gt;&#10;                ${successMessage}&#10;        &lt;/div&gt;&#10;    &lt;/c:if&gt;&#10;    &lt;c:if test=&quot;${not empty errorMessage}&quot;&gt;&#10;        &lt;div class=&quot;notification px-4 py-3 rounded-md shadow-md flex items-center bg-red-100 text-red-800&quot;&gt;&#10;            &lt;i class=&quot;fas fa-exclamation-circle mr-2&quot;&gt;&lt;/i&gt;&#10;                ${errorMessage}&#10;        &lt;/div&gt;&#10;    &lt;/c:if&gt;&#10;&lt;/div&gt;&#10;&#10;&lt;!-- Sidebar --&gt;&#10;&lt;div class=&quot;fixed inset-y-0 left-0 transform -translate-x-full md:translate-x-0 transition duration-200 ease-in-out z-40 w-64 bg-indigo-800 text-white shadow-lg&quot;&gt;&#10;    &lt;div class=&quot;flex items-center justify-center h-16 px-4 border-b border-indigo-700&quot;&gt;&#10;        &lt;div class=&quot;flex items-center space-x-2&quot;&gt;&#10;            &lt;i class=&quot;fas fa-book-open text-2xl text-indigo-300&quot;&gt;&lt;/i&gt;&#10;            &lt;span class=&quot;text-xl font-bold&quot;&gt;PahanEdu&lt;/span&gt;&#10;        &lt;/div&gt;&#10;    &lt;/div&gt;&#10;    &lt;nav class=&quot;mt-6&quot;&gt;&#10;        &lt;div class=&quot;px-4 space-y-1&quot;&gt;&#10;            &lt;a href=&quot;AdminDashboardServlet&quot; class=&quot;flex items-center px-4 py-3 text-indigo-200 hover:text-white hover:bg-indigo-700 rounded-lg&quot;&gt;&#10;                &lt;i class=&quot;fas fa-tachometer-alt mr-3&quot;&gt;&lt;/i&gt; Dashboard&#10;            &lt;/a&gt;&#10;            &lt;a href=&quot;BookServlet&quot; class=&quot;flex items-center px-4 py-3 text-indigo-200 hover:text-white hover:bg-indigo-700 rounded-lg&quot;&gt;&#10;                &lt;i class=&quot;fas fa-book mr-3&quot;&gt;&lt;/i&gt; Books&#10;            &lt;/a&gt;&#10;            &lt;a href=&quot;CustomerServlet&quot; class=&quot;flex items-center px-4 py-3 text-indigo-200 hover:text-white hover:bg-indigo-700 rounded-lg&quot;&gt;&#10;                &lt;i class=&quot;fas fa-users mr-3&quot;&gt;&lt;/i&gt; Customers&#10;            &lt;/a&gt;&#10;            &lt;a href=&quot;CreateBillServlet&quot; class=&quot;flex items-center px-4 py-3 text-white bg-indigo-900 rounded-lg&quot;&gt;&#10;                &lt;i class=&quot;fa-solid fa-money-bill mr-3&quot;&gt;&lt;/i&gt; Create Bill&#10;            &lt;/a&gt;&#10;            &lt;a href=&quot;BillServlet&quot; class=&quot;flex items-center px-4 py-3 text-indigo-200 hover:text-white hover:bg-indigo-700 rounded-lg&quot;&gt;&#10;                &lt;i class=&quot;fas fa-chart-line mr-3&quot;&gt;&lt;/i&gt; Reports&#10;            &lt;/a&gt;&#10;&#10;        &lt;/div&gt;&#10;    &lt;/nav&gt;&#10;&lt;/div&gt;&#10;&#10;&lt;!-- Mobile sidebar toggle --&gt;&#10;&lt;div class=&quot;md:hidden fixed top-4 left-4 z-40&quot;&gt;&#10;    &lt;button id=&quot;sidebar-toggle&quot; class=&quot;p-2 rounded-md bg-indigo-800 text-white focus:outline-none&quot;&gt;&#10;        &lt;i class=&quot;fas fa-bars&quot;&gt;&lt;/i&gt;&#10;    &lt;/button&gt;&#10;&lt;/div&gt;&#10;&#10;&lt;!-- Main Content --&gt;&#10;&lt;div class=&quot;md:ml-64 min-h-screen&quot;&gt;&#10;    &lt;!-- Header --&gt;&#10;    &lt;header class=&quot;bg-white shadow-sm&quot;&gt;&#10;        &lt;div class=&quot;flex justify-between items-center px-6 py-4&quot;&gt;&#10;            &lt;h1 class=&quot;text-2xl font-semibold text-gray-800 flex items-center&quot;&gt;&#10;                &lt;i class=&quot;fas fa-shopping-cart text-blue-600 mr-3&quot;&gt;&lt;/i&gt; Create New Bill&#10;            &lt;/h1&gt;&#10;        &lt;/div&gt;&#10;    &lt;/header&gt;&#10;&#10;    &lt;!-- Main Content Area --&gt;&#10;    &lt;main class=&quot;p-6&quot;&gt;&#10;        &lt;form id=&quot;billing-form&quot; action=&quot;CreateBillServlet&quot; method=&quot;post&quot;&gt;&#10;            &lt;!-- Hidden fields for form data --&gt;&#10;            &lt;input type=&quot;hidden&quot; name=&quot;customerId&quot; id=&quot;customerId&quot;&gt;&#10;            &lt;input type=&quot;hidden&quot; name=&quot;tax&quot; id=&quot;tax-hidden&quot; value=&quot;0&quot;&gt;&#10;            &lt;input type=&quot;hidden&quot; name=&quot;discount&quot; id=&quot;discount-hidden&quot; value=&quot;0&quot;&gt;&#10;            &lt;input type=&quot;hidden&quot; name=&quot;paymentStatus&quot; id=&quot;payment-status-hidden&quot; value=&quot;UNPAID&quot;&gt;&#10;            &lt;input type=&quot;hidden&quot; name=&quot;paymentMethod&quot; id=&quot;payment-method-hidden&quot; value=&quot;CASH&quot;&gt;&#10;            &lt;input type=&quot;hidden&quot; name=&quot;notes&quot; id=&quot;notes-hidden&quot; value=&quot;&quot;&gt;&#10;&#10;            &lt;!-- Dynamic book data container --&gt;&#10;            &lt;div id=&quot;bill-data&quot;&gt;&#10;                &lt;!-- Will be populated by JavaScript --&gt;&#10;            &lt;/div&gt;&#10;&#10;            &lt;div class=&quot;grid grid-cols-1 lg:grid-cols-3 gap-6&quot;&gt;&#10;                &lt;!-- Customer Info Section --&gt;&#10;                &lt;div class=&quot;bg-white rounded-lg shadow p-6&quot;&gt;&#10;                    &lt;h2 class=&quot;text-lg font-semibold mb-4 flex items-center&quot;&gt;&#10;                        &lt;i class=&quot;fas fa-user-circle mr-2 text-indigo-600&quot;&gt;&lt;/i&gt; Select Customer&#10;                    &lt;/h2&gt;&#10;                    &lt;select id=&quot;book-select&quot; class=&quot;flex-1 border border-gray-300 rounded-lg p-3&quot;&gt;&#10;                        &lt;option value=&quot;&quot;&gt;-- Select Book --&lt;/option&gt;&#10;                        &lt;c:forEach var=&quot;book&quot; items=&quot;${books}&quot;&gt;&#10;                            &lt;option value=&quot;${book.id}&quot;&#10;                                    data-price=&quot;${book.price}&quot;&#10;                                    data-title=&quot;${book.title}&quot;&#10;                                    data-stock=&quot;${book.quantity}&quot;&gt;&#10;                                    ${book.title} - Rs. ${book.price} (Stock: ${book.quantity})&#10;                            &lt;/option&gt;&#10;                        &lt;/c:forEach&gt;&#10;                    &lt;/select&gt;&#10;                    &lt;div class=&quot;bg-gray-50 p-4 rounded-lg border border-gray-200&quot;&gt;&#10;                        &lt;p id=&quot;customer-name&quot; class=&quot;font-medium&quot;&gt;No customer selected&lt;/p&gt;&#10;                        &lt;p id=&quot;customer-phone&quot; class=&quot;text-sm text-gray-500&quot;&gt;&lt;/p&gt;&#10;                        &lt;p id=&quot;customer-email&quot; class=&quot;text-sm text-gray-500&quot;&gt;&lt;/p&gt;&#10;                        &lt;p id=&quot;customer-address&quot; class=&quot;text-sm text-gray-500&quot;&gt;&lt;/p&gt;&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;&#10;                &lt;!-- Book Selection + Bill Table --&gt;&#10;                &lt;div class=&quot;lg:col-span-2 bg-white rounded-lg shadow p-6&quot;&gt;&#10;                    &lt;h2 class=&quot;text-lg font-semibold mb-4 flex items-center&quot;&gt;&#10;                        &lt;i class=&quot;fas fa-book-open mr-2 text-indigo-600&quot;&gt;&lt;/i&gt; Select Books&#10;                    &lt;/h2&gt;&#10;                    &lt;div class=&quot;flex space-x-3 mb-6&quot;&gt;&#10;                        &lt;select id=&quot;book-select&quot; class=&quot;flex-1 border border-gray-300 rounded-lg p-3&quot;&gt;&#10;                            &lt;option value=&quot;&quot;&gt;-- Select Book --&lt;/option&gt;&#10;                            &lt;c:forEach var=&quot;book&quot; items=&quot;${books}&quot;&gt;&#10;                                &lt;option value=&quot;${book.id}&quot;&#10;                                        data-price=&quot;${book.price}&quot;&#10;                                        data-title=&quot;${book.title}&quot;&#10;                                        data-stock=&quot;${book.quantity}&quot;&gt;&#10;                                        ${book.title} - Rs. ${book.price} (Stock: ${book.quantity})&#10;                                &lt;/option&gt;&#10;                            &lt;/c:forEach&gt;&#10;                        &lt;/select&gt;&#10;                        &lt;input type=&quot;number&quot; id=&quot;book-qty&quot; min=&quot;1&quot; value=&quot;1&quot; class=&quot;w-20 border rounded-lg p-3 text-center&quot; placeholder=&quot;Qty&quot;&gt;&#10;                        &lt;button type=&quot;button&quot; id=&quot;add-book&quot; class=&quot;bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700&quot;&gt;&#10;                            &lt;i class=&quot;fas fa-plus&quot;&gt;&lt;/i&gt; Add&#10;                        &lt;/button&gt;&#10;                    &lt;/div&gt;&#10;&#10;                    &lt;!-- Bill Table --&gt;&#10;                    &lt;div class=&quot;overflow-x-auto mb-6&quot;&gt;&#10;                        &lt;table class=&quot;w-full text-left border-collapse border border-gray-200&quot;&gt;&#10;                            &lt;thead&gt;&#10;                            &lt;tr class=&quot;bg-gray-100&quot;&gt;&#10;                                &lt;th class=&quot;p-3 border-b&quot;&gt;Book&lt;/th&gt;&#10;                                &lt;th class=&quot;p-3 border-b text-center&quot;&gt;Qty&lt;/th&gt;&#10;                                &lt;th class=&quot;p-3 border-b text-right&quot;&gt;Unit Price&lt;/th&gt;&#10;                                &lt;th class=&quot;p-3 border-b text-right&quot;&gt;Subtotal&lt;/th&gt;&#10;                                &lt;th class=&quot;p-3 border-b text-center&quot;&gt;Action&lt;/th&gt;&#10;                            &lt;/tr&gt;&#10;                            &lt;/thead&gt;&#10;                            &lt;tbody id=&quot;bill-items&quot;&gt;&#10;                            &lt;!-- This will be populated by JavaScript --&gt;&#10;                            &lt;tr id=&quot;empty-bill&quot;&gt;&#10;                                &lt;td colspan=&quot;5&quot; class=&quot;p-3 text-center text-gray-500 border-b&quot;&gt;&#10;                                    No items added&#10;                                &lt;/td&gt;&#10;                            &lt;/tr&gt;&#10;                            &lt;/tbody&gt;&#10;                        &lt;/table&gt;&#10;                    &lt;/div&gt;&#10;&#10;                    &lt;!-- Hidden fields container --&gt;&#10;                    &lt;div id=&quot;bill-data&quot;&gt;&lt;/div&gt;&#10;&#10;                    &lt;!-- Hidden fields for totals --&gt;&#10;                    &lt;input type=&quot;hidden&quot; name=&quot;subtotal&quot; id=&quot;subtotal-hidden&quot; value=&quot;0&quot;&gt;&#10;                    &lt;input type=&quot;hidden&quot; name=&quot;discount&quot; id=&quot;discount-hidden&quot; value=&quot;0&quot;&gt;&#10;                    &lt;input type=&quot;hidden&quot; name=&quot;total&quot; id=&quot;total-hidden&quot; value=&quot;0&quot;&gt;&#10;&#10;                    &lt;!-- Payment &amp; Totals Section --&gt;&#10;                    &lt;div class=&quot;grid grid-cols-1 md:grid-cols-2 gap-6 mb-6&quot;&gt;&#10;                        &lt;!-- Payment Details --&gt;&#10;                        &lt;div&gt;&#10;                            &lt;h3 class=&quot;font-semibold mb-3&quot;&gt;Payment Details&lt;/h3&gt;&#10;                            &lt;div class=&quot;space-y-3&quot;&gt;&#10;                                &lt;div&gt;&#10;                                    &lt;label class=&quot;block text-sm font-medium mb-1&quot;&gt;Payment Method&lt;/label&gt;&#10;                                    &lt;select id=&quot;payment-method&quot; class=&quot;w-full border border-gray-300 rounded-lg p-2&quot;&gt;&#10;                                        &lt;option value=&quot;CASH&quot;&gt;Cash&lt;/option&gt;&#10;                                        &lt;option value=&quot;CARD&quot;&gt;Card&lt;/option&gt;&#10;                                        &lt;option value=&quot;ONLINE&quot;&gt;Online&lt;/option&gt;&#10;                                        &lt;option value=&quot;CHEQUE&quot;&gt;Cheque&lt;/option&gt;&#10;                                    &lt;/select&gt;&#10;                                &lt;/div&gt;&#10;                                &lt;div&gt;&#10;                                    &lt;label class=&quot;block text-sm font-medium mb-1&quot;&gt;Payment Status&lt;/label&gt;&#10;                                    &lt;select id=&quot;payment-status&quot; class=&quot;w-full border border-gray-300 rounded-lg p-2&quot;&gt;&#10;                                        &lt;option value=&quot;UNPAID&quot;&gt;Unpaid&lt;/option&gt;&#10;                                        &lt;option value=&quot;PAID&quot;&gt;Paid&lt;/option&gt;&#10;                                        &lt;option value=&quot;PARTIAL&quot;&gt;Partial&lt;/option&gt;&#10;                                    &lt;/select&gt;&#10;                                &lt;/div&gt;&#10;                                &lt;div&gt;&#10;                                    &lt;label class=&quot;block text-sm font-medium mb-1&quot;&gt;Discount (%)&lt;/label&gt;&#10;                                    &lt;input type=&quot;number&quot; id=&quot;discount&quot; value=&quot;0&quot; min=&quot;0&quot; max=&quot;100&quot;&#10;                                           class=&quot;w-full border border-gray-300 rounded-lg p-2 text-center&quot;&gt;&#10;                                &lt;/div&gt;&#10;                            &lt;/div&gt;&#10;                        &lt;/div&gt;&#10;&#10;                        &lt;!-- Totals --&gt;&#10;                        &lt;div&gt;&#10;                            &lt;h3 class=&quot;font-semibold mb-3&quot;&gt;Bill Summary&lt;/h3&gt;&#10;                            &lt;div class=&quot;bg-gray-50 p-4 rounded-lg space-y-2&quot;&gt;&#10;                                &lt;div class=&quot;flex justify-between&quot;&gt;&#10;                                    &lt;span&gt;Subtotal:&lt;/span&gt;&#10;                                    &lt;span id=&quot;subtotal&quot;&gt;Rs. 0.00&lt;/span&gt;&#10;                                &lt;/div&gt;&#10;                                &lt;div class=&quot;flex justify-between&quot;&gt;&#10;                                    &lt;span&gt;Discount:&lt;/span&gt;&#10;                                    &lt;span id=&quot;discount-amount&quot;&gt;Rs. 0.00&lt;/span&gt;&#10;                                &lt;/div&gt;&#10;                                &lt;div class=&quot;flex justify-between text-lg font-bold border-t pt-2&quot;&gt;&#10;                                    &lt;span&gt;Total:&lt;/span&gt;&#10;                                    &lt;span id=&quot;total&quot;&gt;Rs. 0.00&lt;/span&gt;&#10;                                &lt;/div&gt;&#10;                            &lt;/div&gt;&#10;                        &lt;/div&gt;&#10;                    &lt;/div&gt;&#10;&#10;                    &lt;!-- Notes Section --&gt;&#10;                    &lt;div class=&quot;mb-6&quot;&gt;&#10;                        &lt;label class=&quot;block text-sm font-medium mb-2&quot;&gt;Notes (Optional)&lt;/label&gt;&#10;                        &lt;textarea id=&quot;notes&quot; rows=&quot;3&quot; placeholder=&quot;Add any additional notes here...&quot;&#10;                                  class=&quot;w-full border border-gray-300 rounded-lg p-3&quot;&gt;&lt;/textarea&gt;&#10;                    &lt;/div&gt;&#10;&#10;                    &lt;!-- Action Buttons --&gt;&#10;                    &lt;div class=&quot;flex justify-between&quot;&gt;&#10;                        &lt;button type=&quot;button&quot; onclick=&quot;clearBill()&quot; class=&quot;bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600&quot;&gt;&#10;                            &lt;i class=&quot;fas fa-times mr-2&quot;&gt;&lt;/i&gt; Clear&#10;                        &lt;/button&gt;&#10;                        &lt;div class=&quot;space-x-3&quot;&gt;&#10;                            &lt;button type=&quot;button&quot; onclick=&quot;window.location.href='BillServlet'&quot; class=&quot;bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700&quot;&gt;&#10;                                &lt;i class=&quot;fas fa-list mr-2&quot;&gt;&lt;/i&gt; View Bills&#10;                            &lt;/button&gt;&#10;                            &lt;button type=&quot;submit&quot; id=&quot;complete-billing&quot; class=&quot;bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700&quot;&gt;&#10;                                &lt;i class=&quot;fas fa-check mr-2&quot;&gt;&lt;/i&gt; Create Bill&#10;                            &lt;/button&gt;&#10;                        &lt;/div&gt;&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;            &lt;/div&gt;&#10;        &lt;/form&gt;&#10;    &lt;/main&gt;&#10;&lt;/div&gt;&#10;&#10;&lt;!-- Scripts --&gt;&#10;&lt;script&gt;&#10;    let billItems = [];&#10;&#10;    // Customer selection handler&#10;    document.getElementById('customer-select').addEventListener('change', function () {&#10;        const selected = this.options[this.selectedIndex];&#10;        document.getElementById('customerId').value = this.value;&#10;        document.getElementById('customer-name').textContent = selected.dataset.name || 'No customer selected';&#10;        document.getElementById('customer-phone').textContent = selected.dataset.phone || '';&#10;        document.getElementById('customer-email').textContent = selected.dataset.email || '';&#10;        document.getElementById('customer-address').textContent = selected.dataset.address || '';&#10;    });&#10;&#10;    // Add book to bill&#10;    document.getElementById('add-book').addEventListener('click', function() {&#10;        const bookSelect = document.getElementById('book-select');&#10;        const qtyInput = document.getElementById('book-qty');&#10;&#10;        if (!bookSelect.value) {&#10;            alert('Please select a book');&#10;            return;&#10;        }&#10;&#10;        const quantity = parseInt(qtyInput.value);&#10;        if (isNaN(quantity) || quantity &lt; 1) {&#10;            alert('Please enter a valid quantity');&#10;            return;&#10;        }&#10;&#10;        const selectedOption = bookSelect.options[bookSelect.selectedIndex];&#10;        const bookId = bookSelect.value;&#10;        const bookTitle = selectedOption.dataset.title;&#10;        const price = parseFloat(selectedOption.dataset.price);&#10;        const stock = parseInt(selectedOption.dataset.stock);&#10;&#10;        // Check if book already exists in bill&#10;        const existingItem = billItems.find(item =&gt; item.bookId === bookId);&#10;        if (existingItem) {&#10;            const newQty = existingItem.qty + quantity;&#10;            if (newQty &gt; stock) {&#10;                alert(`Insufficient stock! Available: ${stock}, Total requested: ${newQty}`);&#10;                return;&#10;            }&#10;            existingItem.qty = newQty;&#10;            existingItem.subtotal = existingItem.qty * price;&#10;        } else {&#10;            if (quantity &gt; stock) {&#10;                alert(`Insufficient stock! Available: ${stock}, Requested: ${quantity}`);&#10;                return;&#10;            }&#10;            billItems.push({&#10;                bookId: bookId,&#10;                bookTitle: bookTitle,&#10;                qty: quantity,&#10;                price: price,&#10;                subtotal: price * quantity&#10;            });&#10;        }&#10;&#10;        // Decrement stock in the dropdown&#10;        selectedOption.dataset.stock = stock - quantity;&#10;        selectedOption.textContent = `${bookTitle} - Rs. ${price} (Stock: ${stock - quantity})`;&#10;&#10;        // Reset form&#10;        bookSelect.value = '';&#10;        qtyInput.value = '1';&#10;        renderBill();&#10;    });&#10;&#10;    // Render bill table&#10;    function renderBill() {&#10;        const tbody = document.getElementById('bill-items');&#10;        const billDataDiv = document.getElementById('bill-data');&#10;&#10;        tbody.innerHTML = '';&#10;        billDataDiv.innerHTML = '';&#10;&#10;        let subtotal = 0;&#10;&#10;        if (billItems.length === 0) {&#10;            tbody.innerHTML = `&#10;            &lt;tr id=&quot;empty-bill&quot;&gt;&#10;                &lt;td colspan=&quot;5&quot; class=&quot;p-3 text-center text-gray-500 border-b&quot;&gt;&#10;                    No items added&#10;                &lt;/td&gt;&#10;            &lt;/tr&gt;&#10;        `;&#10;        } else {&#10;            billItems.forEach((item, index) =&gt; {&#10;                subtotal += item.subtotal;&#10;&#10;                // Add row to table&#10;                tbody.innerHTML += `&#10;                &lt;tr class=&quot;border-b hover:bg-gray-50&quot;&gt;&#10;                    &lt;td class=&quot;p-3&quot;&gt;${item.bookTitle}&lt;/td&gt;&#10;                    &lt;td class=&quot;p-3 text-center&quot;&gt;${item.qty}&lt;/td&gt;&#10;                    &lt;td class=&quot;p-3 text-right&quot;&gt;Rs. ${item.price.toFixed(2)}&lt;/td&gt;&#10;                    &lt;td class=&quot;p-3 text-right&quot;&gt;Rs. ${item.subtotal.toFixed(2)}&lt;/td&gt;&#10;                    &lt;td class=&quot;p-3 text-center&quot;&gt;&#10;                        &lt;button type=&quot;button&quot; onclick=&quot;removeItem(${index})&quot;&#10;                                class=&quot;text-red-600 hover:text-red-800&quot;&gt;&#10;                            &lt;i class=&quot;fas fa-trash&quot;&gt;&lt;/i&gt;&#10;                        &lt;/button&gt;&#10;                    &lt;/td&gt;&#10;                &lt;/tr&gt;&#10;            `;&#10;&#10;                // Add hidden form inputs&#10;                const bookInput = document.createElement('input');&#10;                bookInput.type = 'hidden';&#10;                bookInput.name = 'bookId';&#10;                bookInput.value = item.bookId;&#10;&#10;                const qtyInput = document.createElement('input');&#10;                qtyInput.type = 'hidden';&#10;                qtyInput.name = 'quantity';&#10;                qtyInput.value = item.qty;&#10;&#10;                billDataDiv.appendChild(bookInput);&#10;                billDataDiv.appendChild(qtyInput);&#10;            });&#10;        }&#10;&#10;        updateTotals(subtotal);&#10;    }&#10;&#10;    // Update totals calculation&#10;    function updateTotals(subtotal) {&#10;        const discountPercent = parseFloat(document.getElementById('discount').value) || 0;&#10;        const discountAmount = subtotal * (discountPercent / 100);&#10;        const total = subtotal - discountAmount;&#10;&#10;        document.getElementById('subtotal').textContent = `Rs. ${subtotal.toFixed(2)}`;&#10;        document.getElementById('discount-amount').textContent = `Rs. ${discountAmount.toFixed(2)}`;&#10;        document.getElementById('total').textContent = `Rs. ${total.toFixed(2)}`;&#10;&#10;        // Update hidden fields&#10;        document.getElementById('subtotal-hidden').value = subtotal.toFixed(2);&#10;        document.getElementById('discount-hidden').value = discountAmount.toFixed(2);&#10;        document.getElementById('total-hidden').value = total.toFixed(2);&#10;    }&#10;&#10;    // Remove item from bill&#10;    function removeItem(index) {&#10;        billItems.splice(index, 1);&#10;        renderBill();&#10;    }&#10;&#10;    // Clear entire bill&#10;    function clearBill() {&#10;        if (confirm('Are you sure you want to clear the entire bill?')) {&#10;            billItems = [];&#10;            renderBill();&#10;        }&#10;    }&#10;&#10;    // Submit billing form&#10;    document.getElementById('billing-form').addEventListener('submit', function(event) {&#10;        event.preventDefault();&#10;        if (billItems.length === 0) {&#10;            alert('Please add at least one book to the bill.');&#10;            return;&#10;        }&#10;&#10;        // Update hidden fields before submission&#10;        document.getElementById('payment-status-hidden').value = document.getElementById('payment-status').value;&#10;        document.getElementById('payment-method-hidden').value = document.getElementById('payment-method').value;&#10;        document.getElementById('notes-hidden').value = document.getElementById('notes').value;&#10;&#10;        // Create FormData and append all form fields&#10;        const formData = new FormData(this);&#10;        &#10;        // Submit the form using fetch&#10;        fetch('CreateBillServlet', {&#10;            method: 'POST',&#10;            body: formData&#10;        })&#10;        .then(response =&gt; response.json())&#10;        .then(data =&gt; {&#10;            if (data.success) {&#10;                alert(data.message);&#10;                window.location.href = 'BillServlet'; // Redirect to bills list&#10;            } else {&#10;                alert(data.message || 'Error creating bill');&#10;            }&#10;        })&#10;        .catch(error =&gt; {&#10;            alert('Error: ' + error.message);&#10;        });&#10;    });&#10;&#10;    // ...existing code...&#10;&lt;/script&gt;&#10;&#10;&lt;/body&gt;&#10;&lt;/html&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/webapp/Report.jsp">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/webapp/Report.jsp" />
              <option name="originalContent" value="&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;&#10;&lt;%@ taglib uri=&quot;http://java.sun.com/jsp/jstl/core&quot; prefix=&quot;c&quot; %&gt;&#10;&lt;%@ taglib uri=&quot;http://java.sun.com/jsp/jstl/fmt&quot; prefix=&quot;fmt&quot; %&gt;&#10;&lt;!DOCTYPE html&gt;&#10;&lt;html lang=&quot;en&quot;&gt;&#10;&lt;head&gt;&#10;    &lt;meta charset=&quot;UTF-8&quot;&gt;&#10;    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;&#10;    &lt;title&gt;Bills Report - PahanEdu Bookshop&lt;/title&gt;&#10;    &lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;&#10;    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css&quot;&gt;&#10;    &lt;style&gt;&#10;        /* Scrollbar styles */&#10;        ::-webkit-scrollbar { width: 8px; }&#10;        ::-webkit-scrollbar-track { background: #f1f1f1; }&#10;        ::-webkit-scrollbar-thumb { background: #888; border-radius: 4px; }&#10;        ::-webkit-scrollbar-thumb:hover { background: #555; }&#10;&#10;        /* Notification styles */&#10;        .notification { animation: slideIn 0.3s ease-out, fadeOut 0.5s ease 3s forwards; }&#10;        @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }&#10;        @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }&#10;&#10;        /* Print styles */&#10;        @media print {&#10;            .no-print { display: none !important; }&#10;            body { font-size: 12px; }&#10;            .print-break { page-break-after: always; }&#10;        }&#10;&#10;        /* Status badges */&#10;        .status-paid { @apply bg-green-100 text-green-800; }&#10;        .status-unpaid { @apply bg-red-100 text-red-800; }&#10;        .status-partial { @apply bg-yellow-100 text-yellow-800; }&#10;    &lt;/style&gt;&#10;&lt;/head&gt;&#10;&lt;body class=&quot;bg-gray-50 font-sans&quot;&gt;&#10;&#10;&lt;!-- Notification Area --&gt;&#10;&lt;div id=&quot;notification-area&quot; class=&quot;fixed top-4 right-4 z-50 space-y-2&quot;&gt;&#10;    &lt;c:if test=&quot;${not empty successMessage}&quot;&gt;&#10;        &lt;div class=&quot;notification px-4 py-3 rounded-md shadow-md flex items-center bg-green-100 text-green-800&quot;&gt;&#10;            &lt;i class=&quot;fas fa-check-circle mr-2&quot;&gt;&lt;/i&gt;&#10;                ${successMessage}&#10;        &lt;/div&gt;&#10;    &lt;/c:if&gt;&#10;    &lt;c:if test=&quot;${not empty errorMessage}&quot;&gt;&#10;        &lt;div class=&quot;notification px-4 py-3 rounded-md shadow-md flex items-center bg-red-100 text-red-800&quot;&gt;&#10;            &lt;i class=&quot;fas fa-exclamation-circle mr-2&quot;&gt;&lt;/i&gt;&#10;                ${errorMessage}&#10;        &lt;/div&gt;&#10;    &lt;/c:if&gt;&#10;&lt;/div&gt;&#10;&#10;&lt;!-- Sidebar --&gt;&#10;&lt;div class=&quot;fixed inset-y-0 left-0 transform -translate-x-full md:translate-x-0 transition duration-200 ease-in-out z-40 w-64 bg-indigo-800 text-white shadow-lg&quot;&gt;&#10;    &lt;div class=&quot;flex items-center justify-center h-16 px-4 border-b border-indigo-700&quot;&gt;&#10;        &lt;div class=&quot;flex items-center space-x-2&quot;&gt;&#10;            &lt;i class=&quot;fas fa-book-open text-2xl text-indigo-300&quot;&gt;&lt;/i&gt;&#10;            &lt;span class=&quot;text-xl font-bold&quot;&gt;PahanEdu&lt;/span&gt;&#10;        &lt;/div&gt;&#10;    &lt;/div&gt;&#10;    &lt;nav class=&quot;mt-6&quot;&gt;&#10;        &lt;div class=&quot;px-4 space-y-1&quot;&gt;&#10;            &lt;a href=&quot;AdminDashboardServlet&quot; class=&quot;flex items-center px-4 py-3 text-indigo-200 hover:text-white hover:bg-indigo-700 rounded-lg&quot;&gt;&#10;                &lt;i class=&quot;fas fa-tachometer-alt mr-3&quot;&gt;&lt;/i&gt; Dashboard&#10;            &lt;/a&gt;&#10;            &lt;a href=&quot;BookServlet&quot; class=&quot;flex items-center px-4 py-3 text-indigo-200 hover:text-white hover:bg-indigo-700 rounded-lg&quot;&gt;&#10;                &lt;i class=&quot;fas fa-book mr-3&quot;&gt;&lt;/i&gt; Books&#10;            &lt;/a&gt;&#10;            &lt;a href=&quot;CustomerServlet&quot; class=&quot;flex items-center px-4 py-3 text-indigo-200 hover:text-white hover:bg-indigo-700 rounded-lg&quot;&gt;&#10;                &lt;i class=&quot;fas fa-users mr-3&quot;&gt;&lt;/i&gt; Customers&#10;            &lt;/a&gt;&#10;            &lt;a href=&quot;CreateBillServlet&quot; class=&quot;flex items-center px-4 py-3 text-indigo-200 hover:text-white hover:bg-indigo-700 rounded-lg&quot;&gt;&#10;                &lt;i class=&quot;fa-solid fa-money-bill mr-3&quot;&gt;&lt;/i&gt;Bill&#10;            &lt;/a&gt;&#10;            &lt;a href=&quot;BillServlet&quot; class=&quot;flex items-center px-4 py-3 text-white bg-indigo-900 rounded-lg&quot;&gt;&#10;                &lt;i class=&quot;fas fa-chart-line mr-3&quot;&gt;&lt;/i&gt;Report&#10;            &lt;/a&gt;&#10;        &lt;/div&gt;&#10;    &lt;/nav&gt;&#10;&lt;/div&gt;&#10;&#10;&lt;!-- Mobile sidebar toggle --&gt;&#10;&lt;div class=&quot;md:hidden fixed top-4 left-4 z-40 no-print&quot;&gt;&#10;    &lt;button id=&quot;sidebar-toggle&quot; class=&quot;p-2 rounded-md bg-indigo-800 text-white focus:outline-none&quot;&gt;&#10;        &lt;i class=&quot;fas fa-bars&quot;&gt;&lt;/i&gt;&#10;    &lt;/button&gt;&#10;&lt;/div&gt;&#10;&#10;&lt;!-- Main Content --&gt;&#10;&lt;div class=&quot;md:ml-64 min-h-screen&quot;&gt;&#10;    &lt;!-- Header --&gt;&#10;    &lt;header class=&quot;bg-white shadow-sm no-print&quot;&gt;&#10;        &lt;div class=&quot;flex justify-between items-center px-6 py-4&quot;&gt;&#10;            &lt;h1 class=&quot;text-2xl font-semibold text-gray-800 flex items-center&quot;&gt;&#10;                &lt;i class=&quot;fas fa-chart-line text-blue-600 mr-3&quot;&gt;&lt;/i&gt; Bills Report&#10;            &lt;/h1&gt;&#10;            &lt;div class=&quot;flex space-x-3&quot;&gt;&#10;                &lt;button onclick=&quot;window.print()&quot; class=&quot;bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700&quot;&gt;&#10;                    &lt;i class=&quot;fas fa-print mr-2&quot;&gt;&lt;/i&gt; Print Report&#10;                &lt;/button&gt;&#10;                &lt;a href=&quot;CreateBillServlet&quot; class=&quot;bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700&quot;&gt;&#10;                    &lt;i class=&quot;fas fa-plus mr-2&quot;&gt;&lt;/i&gt; New Bill&#10;                &lt;/a&gt;&#10;            &lt;/div&gt;&#10;        &lt;/div&gt;&#10;    &lt;/header&gt;&#10;&#10;    &lt;!-- Main Content Area --&gt;&#10;    &lt;main class=&quot;p-6&quot;&gt;&#10;        &lt;!-- Summary Cards --&gt;&#10;        &lt;div class=&quot;grid grid-cols-1 md:grid-cols-4 gap-6 mb-6&quot;&gt;&#10;            &lt;div class=&quot;bg-white rounded-lg shadow p-6&quot;&gt;&#10;                &lt;div class=&quot;flex items-center&quot;&gt;&#10;                    &lt;div class=&quot;p-3 rounded-full bg-blue-100 text-blue-600&quot;&gt;&#10;                        &lt;i class=&quot;fas fa-file-invoice text-xl&quot;&gt;&lt;/i&gt;&#10;                    &lt;/div&gt;&#10;                    &lt;div class=&quot;ml-4&quot;&gt;&#10;                        &lt;p class=&quot;text-sm font-medium text-gray-600&quot;&gt;Total Bills&lt;/p&gt;&#10;                        &lt;p class=&quot;text-2xl font-semibold text-gray-900&quot;&gt;${totalBills != null ? totalBills : 0}&lt;/p&gt;&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;bg-white rounded-lg shadow p-6&quot;&gt;&#10;                &lt;div class=&quot;flex items-center&quot;&gt;&#10;                    &lt;div class=&quot;p-3 rounded-full bg-green-100 text-green-600&quot;&gt;&#10;                        &lt;i class=&quot;fas fa-check-circle text-xl&quot;&gt;&lt;/i&gt;&#10;                    &lt;/div&gt;&#10;                    &lt;div class=&quot;ml-4&quot;&gt;&#10;                        &lt;p class=&quot;text-sm font-medium text-gray-600&quot;&gt;Paid Bills&lt;/p&gt;&#10;                        &lt;p class=&quot;text-2xl font-semibold text-gray-900&quot;&gt;${paidBills != null ? paidBills : 0}&lt;/p&gt;&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;bg-white rounded-lg shadow p-6&quot;&gt;&#10;                &lt;div class=&quot;flex items-center&quot;&gt;&#10;                    &lt;div class=&quot;p-3 rounded-full bg-red-100 text-red-600&quot;&gt;&#10;                        &lt;i class=&quot;fas fa-exclamation-circle text-xl&quot;&gt;&lt;/i&gt;&#10;                    &lt;/div&gt;&#10;                    &lt;div class=&quot;ml-4&quot;&gt;&#10;                        &lt;p class=&quot;text-sm font-medium text-gray-600&quot;&gt;Unpaid Bills&lt;/p&gt;&#10;                        &lt;p class=&quot;text-2xl font-semibold text-gray-900&quot;&gt;${unpaidBills != null ? unpaidBills : 0}&lt;/p&gt;&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;bg-white rounded-lg shadow p-6&quot;&gt;&#10;                &lt;div class=&quot;flex items-center&quot;&gt;&#10;                    &lt;div class=&quot;p-3 rounded-full bg-yellow-100 text-yellow-600&quot;&gt;&#10;                        &lt;i class=&quot;fas fa-dollar-sign text-xl&quot;&gt;&lt;/i&gt;&#10;                    &lt;/div&gt;&#10;                    &lt;div class=&quot;ml-4&quot;&gt;&#10;                        &lt;p class=&quot;text-sm font-medium text-gray-600&quot;&gt;Total Sales&lt;/p&gt;&#10;                        &lt;p class=&quot;text-2xl font-semibold text-gray-900&quot;&gt;Rs. &lt;fmt:formatNumber value=&quot;${totalSales != null ? totalSales : 0}&quot; pattern=&quot;#,##0.00&quot;/&gt;&lt;/p&gt;&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;            &lt;/div&gt;&#10;        &lt;/div&gt;&#10;&#10;        &lt;!-- Filters --&gt;&#10;        &lt;div class=&quot;bg-white rounded-lg shadow mb-6 p-6 no-print&quot;&gt;&#10;            &lt;h2 class=&quot;text-lg font-semibold mb-4 flex items-center&quot;&gt;&#10;                &lt;i class=&quot;fas fa-filter mr-2 text-indigo-600&quot;&gt;&lt;/i&gt; Filters&#10;            &lt;/h2&gt;&#10;            &lt;form action=&quot;BillServlet&quot; method=&quot;get&quot; class=&quot;grid grid-cols-1 md:grid-cols-5 gap-4&quot;&gt;&#10;                &lt;div&gt;&#10;                    &lt;label class=&quot;block text-sm font-medium mb-1&quot;&gt;Payment Status&lt;/label&gt;&#10;                    &lt;select name=&quot;paymentStatus&quot; class=&quot;w-full border border-gray-300 rounded-lg p-2&quot;&gt;&#10;                        &lt;option value=&quot;&quot;&gt;All Status&lt;/option&gt;&#10;                        &lt;option value=&quot;PAID&quot; ${param.paymentStatus == 'PAID' ? 'selected' : ''}&gt;Paid&lt;/option&gt;&#10;                        &lt;option value=&quot;UNPAID&quot; ${param.paymentStatus == 'UNPAID' ? 'selected' : ''}&gt;Unpaid&lt;/option&gt;&#10;                        &lt;option value=&quot;PARTIAL&quot; ${param.paymentStatus == 'PARTIAL' ? 'selected' : ''}&gt;Partial&lt;/option&gt;&#10;                    &lt;/select&gt;&#10;                &lt;/div&gt;&#10;                &lt;div&gt;&#10;                    &lt;label class=&quot;block text-sm font-medium mb-1&quot;&gt;Payment Method&lt;/label&gt;&#10;                    &lt;select name=&quot;paymentMethod&quot; class=&quot;w-full border border-gray-300 rounded-lg p-2&quot;&gt;&#10;                        &lt;option value=&quot;&quot;&gt;All Methods&lt;/option&gt;&#10;                        &lt;option value=&quot;CASH&quot; ${param.paymentMethod == 'CASH' ? 'selected' : ''}&gt;Cash&lt;/option&gt;&#10;                        &lt;option value=&quot;CARD&quot; ${param.paymentMethod == 'CARD' ? 'selected' : ''}&gt;Card&lt;/option&gt;&#10;                        &lt;option value=&quot;ONLINE&quot; ${param.paymentMethod == 'ONLINE' ? 'selected' : ''}&gt;Online&lt;/option&gt;&#10;                        &lt;option value=&quot;CHEQUE&quot; ${param.paymentMethod == 'CHEQUE' ? 'selected' : ''}&gt;Cheque&lt;/option&gt;&#10;                    &lt;/select&gt;&#10;                &lt;/div&gt;&#10;                &lt;div&gt;&#10;                    &lt;label class=&quot;block text-sm font-medium mb-1&quot;&gt;From Date&lt;/label&gt;&#10;                    &lt;input type=&quot;date&quot; name=&quot;fromDate&quot; value=&quot;${param.fromDate}&quot;&#10;                           class=&quot;w-full border border-gray-300 rounded-lg p-2&quot;&gt;&#10;                &lt;/div&gt;&#10;                &lt;div&gt;&#10;                    &lt;label class=&quot;block text-sm font-medium mb-1&quot;&gt;To Date&lt;/label&gt;&#10;                    &lt;input type=&quot;date&quot; name=&quot;toDate&quot; value=&quot;${param.toDate}&quot;&#10;                           class=&quot;w-full border border-gray-300 rounded-lg p-2&quot;&gt;&#10;                &lt;/div&gt;&#10;                &lt;div class=&quot;flex items-end&quot;&gt;&#10;                    &lt;button type=&quot;submit&quot; class=&quot;w-full bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700&quot;&gt;&#10;                        &lt;i class=&quot;fas fa-search mr-2&quot;&gt;&lt;/i&gt; Filter&#10;                    &lt;/button&gt;&#10;                &lt;/div&gt;&#10;            &lt;/form&gt;&#10;        &lt;/div&gt;&#10;&#10;        &lt;!-- Search --&gt;&#10;        &lt;div class=&quot;bg-white rounded-lg shadow mb-6 p-6 no-print&quot;&gt;&#10;            &lt;div class=&quot;flex gap-4&quot;&gt;&#10;                &lt;div class=&quot;flex-1&quot;&gt;&#10;                    &lt;input type=&quot;text&quot; id=&quot;search-input&quot; placeholder=&quot;Search by Bill Number, Customer Name, Email, or Phone...&quot;&#10;                           class=&quot;w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-indigo-500&quot;&gt;&#10;                &lt;/div&gt;&#10;                &lt;button onclick=&quot;clearSearch()&quot; class=&quot;bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600&quot;&gt;&#10;                    &lt;i class=&quot;fas fa-times mr-2&quot;&gt;&lt;/i&gt; Clear&#10;                &lt;/button&gt;&#10;            &lt;/div&gt;&#10;        &lt;/div&gt;&#10;&#10;        &lt;!-- Bills Table --&gt;&#10;        &lt;div class=&quot;bg-white rounded-lg shadow&quot;&gt;&#10;            &lt;div class=&quot;px-6 py-4 border-b border-gray-200&quot;&gt;&#10;                &lt;h2 class=&quot;text-lg font-semibold flex items-center&quot;&gt;&#10;                    &lt;i class=&quot;fas fa-list mr-2 text-indigo-600&quot;&gt;&lt;/i&gt; Bills List&#10;                    &lt;span class=&quot;ml-2 text-sm text-gray-500&quot;&gt;&#10;                        (${bills != null ? bills.size() : 0} bills found)&#10;                    &lt;/span&gt;&#10;                &lt;/h2&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;overflow-x-auto&quot;&gt;&#10;                &lt;table class=&quot;w-full&quot;&gt;&#10;                    &lt;thead class=&quot;bg-gray-50&quot;&gt;&#10;                    &lt;tr&gt;&#10;                        &lt;th class=&quot;px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider&quot;&gt;&#10;                            Bill Details&#10;                        &lt;/th&gt;&#10;                        &lt;th class=&quot;px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider&quot;&gt;&#10;                            Customer&#10;                        &lt;/th&gt;&#10;                        &lt;th class=&quot;px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider&quot;&gt;&#10;                            Books&#10;                        &lt;/th&gt;&#10;                        &lt;th class=&quot;px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider&quot;&gt;&#10;                            Amount&#10;                        &lt;/th&gt;&#10;                        &lt;th class=&quot;px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider&quot;&gt;&#10;                            Payment&#10;                        &lt;/th&gt;&#10;                    &lt;/tr&gt;&#10;                    &lt;/thead&gt;&#10;                    &lt;tbody class=&quot;bg-white divide-y divide-gray-200&quot;&gt;&#10;                    &lt;c:forEach var=&quot;bill&quot; items=&quot;${bills}&quot;&gt;&#10;                        &lt;tr&gt;&#10;                            &lt;td class=&quot;px-6 py-4&quot;&gt;${bill.billNumber}&lt;/td&gt;&#10;                            &lt;td class=&quot;px-6 py-4&quot;&gt;${bill.customerName}&lt;/td&gt;&#10;                            &lt;td class=&quot;px-6 py-4&quot;&gt;&#10;                                &lt;ul&gt;&#10;                                    &lt;c:forEach var=&quot;book&quot; items=&quot;${bill.books}&quot;&gt;&#10;                                        &lt;li&gt;${book.title} (Qty: ${book.quantity})&lt;/li&gt;&#10;                                    &lt;/c:forEach&gt;&#10;                                &lt;/ul&gt;&#10;                            &lt;/td&gt;&#10;                            &lt;td class=&quot;px-6 py-4 text-right&quot;&gt;Rs. ${bill.totalAmount}&lt;/td&gt;&#10;                            &lt;td class=&quot;px-6 py-4 text-center&quot;&gt;${bill.paymentStatus}&lt;/td&gt;&#10;&#10;&lt;!-- Payment Update Modal --&gt;&#10;&lt;div id=&quot;payment-modal&quot; class=&quot;fixed inset-0 bg-gray-600 bg-opacity-50 hidden z-50&quot;&gt;&#10;    &lt;div class=&quot;flex items-center justify-center min-h-screen p-4&quot;&gt;&#10;        &lt;div class=&quot;bg-white rounded-lg max-w-md w-full p-6&quot;&gt;&#10;            &lt;h3 class=&quot;text-lg font-medium mb-4&quot;&gt;Update Payment Status&lt;/h3&gt;&#10;            &lt;form id=&quot;payment-form&quot; method=&quot;post&quot; action=&quot;ViewBillServlet&quot;&gt;&#10;                &lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;updatePayment&quot;&gt;&#10;                &lt;input type=&quot;hidden&quot; name=&quot;billId&quot; id=&quot;modal-bill-id&quot;&gt;&#10;&#10;                &lt;div class=&quot;mb-4&quot;&gt;&#10;                    &lt;label class=&quot;block text-sm font-medium mb-2&quot;&gt;Payment Status&lt;/label&gt;&#10;                    &lt;select name=&quot;paymentStatus&quot; id=&quot;modal-payment-status&quot; class=&quot;w-full border border-gray-300 rounded-lg p-2&quot;&gt;&#10;                        &lt;option value=&quot;PAID&quot;&gt;Paid&lt;/option&gt;&#10;                        &lt;option value=&quot;UNPAID&quot;&gt;Unpaid&lt;/option&gt;&#10;                        &lt;option value=&quot;PARTIAL&quot;&gt;Partial&lt;/option&gt;&#10;                    &lt;/select&gt;&#10;                &lt;/div&gt;&#10;&#10;                &lt;div class=&quot;mb-4&quot;&gt;&#10;                    &lt;label class=&quot;block text-sm font-medium mb-2&quot;&gt;Payment Method&lt;/label&gt;&#10;                    &lt;select name=&quot;paymentMethod&quot; id=&quot;modal-payment-method&quot; class=&quot;w-full border border-gray-300 rounded-lg p-2&quot;&gt;&#10;                        &lt;option value=&quot;CASH&quot;&gt;Cash&lt;/option&gt;&#10;                        &lt;option value=&quot;CARD&quot;&gt;Card&lt;/option&gt;&#10;                        &lt;option value=&quot;ONLINE&quot;&gt;Online&lt;/option&gt;&#10;                        &lt;option value=&quot;CHEQUE&quot;&gt;Cheque&lt;/option&gt;&#10;                    &lt;/select&gt;&#10;                &lt;/div&gt;&#10;&#10;                &lt;div class=&quot;flex justify-end space-x-3&quot;&gt;&#10;                    &lt;button type=&quot;button&quot; onclick=&quot;closePaymentModal()&quot;&#10;                            class=&quot;bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600&quot;&gt;&#10;                        Cancel&#10;                    &lt;/button&gt;&#10;                    &lt;button type=&quot;submit&quot; class=&quot;bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700&quot;&gt;&#10;                        Update&#10;                    &lt;/button&gt;&#10;                &lt;/div&gt;&#10;            &lt;/form&gt;&#10;        &lt;/div&gt;&#10;    &lt;/div&gt;&#10;&lt;/div&gt;&#10;&#10;&lt;!-- Scripts --&gt;&#10;&lt;script&gt;&#10;    // Search functionality&#10;    document.getElementById('search-input').addEventListener('input', function() {&#10;        const searchTerm = this.value.toLowerCase();&#10;        const rows = document.querySelectorAll('.searchable-row');&#10;&#10;        rows.forEach(row =&gt; {&#10;            const searchData = row.getAttribute('data-search').toLowerCase();&#10;            if (searchData.includes(searchTerm)) {&#10;                row.style.display = '';&#10;            } else {&#10;                row.style.display = 'none';&#10;            }&#10;        });&#10;    });&#10;&#10;    // Clear search&#10;    function clearSearch() {&#10;        document.getElementById('search-input').value = '';&#10;        document.querySelectorAll('.searchable-row').forEach(row =&gt; {&#10;            row.style.display = '';&#10;        });&#10;    }&#10;&#10;    // Payment status update&#10;    function updatePaymentStatus(billId, billNumber) {&#10;        document.getElementById('modal-bill-id').value = billId;&#10;        document.getElementById('payment-modal').classList.remove('hidden');&#10;    }&#10;&#10;    function closePaymentModal() {&#10;        document.getElementById('payment-modal').classList.add('hidden');&#10;    }&#10;&#10;    // Delete bill&#10;    function deleteBill(billId, billNumber) {&#10;        if (confirm(`Are you sure you want to delete bill ${billNumber}? This action cannot be undone.`)) {&#10;            window.location.href = `BillServlet?action=delete&amp;id=${billId}`;&#10;        }&#10;    }&#10;&#10;    // Mobile sidebar toggle&#10;    document.getElementById('sidebar-toggle').addEventListener('click', function() {&#10;        const sidebar = document.querySelector('.fixed.inset-y-0.left-0');&#10;        sidebar.classList.toggle('-translate-x-full');&#10;    });&#10;&#10;    // Auto-hide notifications&#10;    setTimeout(() =&gt; {&#10;        document.querySelectorAll('.notification').forEach(el =&gt; el.remove());&#10;    }, 5000);&#10;&lt;/script&gt;&#10;&#10;&lt;/body&gt;&#10;&lt;/html&gt;" />
              <option name="updatedContent" value="&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;&#10;&lt;%@ taglib uri=&quot;http://java.sun.com/jsp/jstl/core&quot; prefix=&quot;c&quot; %&gt;&#10;&lt;%@ taglib uri=&quot;http://java.sun.com/jsp/jstl/fmt&quot; prefix=&quot;fmt&quot; %&gt;&#10;&lt;!DOCTYPE html&gt;&#10;&lt;html lang=&quot;en&quot;&gt;&#10;&lt;head&gt;&#10;    &lt;meta charset=&quot;UTF-8&quot;&gt;&#10;    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;&#10;    &lt;title&gt;Bills Report - PahanEdu Bookshop&lt;/title&gt;&#10;    &lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;&#10;    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css&quot;&gt;&#10;    &lt;style&gt;&#10;        /* Scrollbar styles */&#10;        ::-webkit-scrollbar { width: 8px; }&#10;        ::-webkit-scrollbar-track { background: #f1f1f1; }&#10;        ::-webkit-scrollbar-thumb { background: #888; border-radius: 4px; }&#10;        ::-webkit-scrollbar-thumb:hover { background: #555; }&#10;&#10;        /* Notification styles */&#10;        .notification { animation: slideIn 0.3s ease-out, fadeOut 0.5s ease 3s forwards; }&#10;        @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }&#10;        @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }&#10;&#10;        /* Print styles */&#10;        @media print {&#10;            .no-print { display: none !important; }&#10;            body { font-size: 12px; }&#10;            .print-break { page-break-after: always; }&#10;        }&#10;&#10;        /* Status badges */&#10;        .status-paid { @apply bg-green-100 text-green-800; }&#10;        .status-unpaid { @apply bg-red-100 text-red-800; }&#10;        .status-partial { @apply bg-yellow-100 text-yellow-800; }&#10;    &lt;/style&gt;&#10;&lt;/head&gt;&#10;&lt;body class=&quot;bg-gray-50 font-sans&quot;&gt;&#10;&#10;&lt;!-- Notification Area --&gt;&#10;&lt;div id=&quot;notification-area&quot; class=&quot;fixed top-4 right-4 z-50 space-y-2&quot;&gt;&#10;    &lt;c:if test=&quot;${not empty successMessage}&quot;&gt;&#10;        &lt;div class=&quot;notification px-4 py-3 rounded-md shadow-md flex items-center bg-green-100 text-green-800&quot;&gt;&#10;            &lt;i class=&quot;fas fa-check-circle mr-2&quot;&gt;&lt;/i&gt;&#10;                ${successMessage}&#10;        &lt;/div&gt;&#10;    &lt;/c:if&gt;&#10;    &lt;c:if test=&quot;${not empty errorMessage}&quot;&gt;&#10;        &lt;div class=&quot;notification px-4 py-3 rounded-md shadow-md flex items-center bg-red-100 text-red-800&quot;&gt;&#10;            &lt;i class=&quot;fas fa-exclamation-circle mr-2&quot;&gt;&lt;/i&gt;&#10;                ${errorMessage}&#10;        &lt;/div&gt;&#10;    &lt;/c:if&gt;&#10;&lt;/div&gt;&#10;&#10;&lt;!-- Sidebar --&gt;&#10;&lt;div class=&quot;fixed inset-y-0 left-0 transform -translate-x-full md:translate-x-0 transition duration-200 ease-in-out z-40 w-64 bg-indigo-800 text-white shadow-lg&quot;&gt;&#10;    &lt;div class=&quot;flex items-center justify-center h-16 px-4 border-b border-indigo-700&quot;&gt;&#10;        &lt;div class=&quot;flex items-center space-x-2&quot;&gt;&#10;            &lt;i class=&quot;fas fa-book-open text-2xl text-indigo-300&quot;&gt;&lt;/i&gt;&#10;            &lt;span class=&quot;text-xl font-bold&quot;&gt;PahanEdu&lt;/span&gt;&#10;        &lt;/div&gt;&#10;    &lt;/div&gt;&#10;    &lt;nav class=&quot;mt-6&quot;&gt;&#10;        &lt;div class=&quot;px-4 space-y-1&quot;&gt;&#10;            &lt;a href=&quot;AdminDashboardServlet&quot; class=&quot;flex items-center px-4 py-3 text-indigo-200 hover:text-white hover:bg-indigo-700 rounded-lg&quot;&gt;&#10;                &lt;i class=&quot;fas fa-tachometer-alt mr-3&quot;&gt;&lt;/i&gt; Dashboard&#10;            &lt;/a&gt;&#10;            &lt;a href=&quot;BookServlet&quot; class=&quot;flex items-center px-4 py-3 text-indigo-200 hover:text-white hover:bg-indigo-700 rounded-lg&quot;&gt;&#10;                &lt;i class=&quot;fas fa-book mr-3&quot;&gt;&lt;/i&gt; Books&#10;            &lt;/a&gt;&#10;            &lt;a href=&quot;CustomerServlet&quot; class=&quot;flex items-center px-4 py-3 text-indigo-200 hover:text-white hover:bg-indigo-700 rounded-lg&quot;&gt;&#10;                &lt;i class=&quot;fas fa-users mr-3&quot;&gt;&lt;/i&gt; Customers&#10;            &lt;/a&gt;&#10;            &lt;a href=&quot;CreateBillServlet&quot; class=&quot;flex items-center px-4 py-3 text-indigo-200 hover:text-white hover:bg-indigo-700 rounded-lg&quot;&gt;&#10;                &lt;i class=&quot;fa-solid fa-money-bill mr-3&quot;&gt;&lt;/i&gt;Bill&#10;            &lt;/a&gt;&#10;            &lt;a href=&quot;BillServlet&quot; class=&quot;flex items-center px-4 py-3 text-white bg-indigo-900 rounded-lg&quot;&gt;&#10;                &lt;i class=&quot;fas fa-chart-line mr-3&quot;&gt;&lt;/i&gt;Report&#10;            &lt;/a&gt;&#10;        &lt;/div&gt;&#10;    &lt;/nav&gt;&#10;&lt;/div&gt;&#10;&#10;&lt;!-- Mobile sidebar toggle --&gt;&#10;&lt;div class=&quot;md:hidden fixed top-4 left-4 z-40 no-print&quot;&gt;&#10;    &lt;button id=&quot;sidebar-toggle&quot; class=&quot;p-2 rounded-md bg-indigo-800 text-white focus:outline-none&quot;&gt;&#10;        &lt;i class=&quot;fas fa-bars&quot;&gt;&lt;/i&gt;&#10;    &lt;/button&gt;&#10;&lt;/div&gt;&#10;&#10;&lt;!-- Main Content --&gt;&#10;&lt;div class=&quot;md:ml-64 min-h-screen&quot;&gt;&#10;    &lt;!-- Header --&gt;&#10;    &lt;header class=&quot;bg-white shadow-sm no-print&quot;&gt;&#10;        &lt;div class=&quot;flex justify-between items-center px-6 py-4&quot;&gt;&#10;            &lt;h1 class=&quot;text-2xl font-semibold text-gray-800 flex items-center&quot;&gt;&#10;                &lt;i class=&quot;fas fa-chart-line text-blue-600 mr-3&quot;&gt;&lt;/i&gt; Bills Report&#10;            &lt;/h1&gt;&#10;            &lt;div class=&quot;flex space-x-3&quot;&gt;&#10;                &lt;button onclick=&quot;window.print()&quot; class=&quot;bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700&quot;&gt;&#10;                    &lt;i class=&quot;fas fa-print mr-2&quot;&gt;&lt;/i&gt; Print Report&#10;                &lt;/button&gt;&#10;                &lt;a href=&quot;CreateBillServlet&quot; class=&quot;bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700&quot;&gt;&#10;                    &lt;i class=&quot;fas fa-plus mr-2&quot;&gt;&lt;/i&gt; New Bill&#10;                &lt;/a&gt;&#10;            &lt;/div&gt;&#10;        &lt;/div&gt;&#10;    &lt;/header&gt;&#10;&#10;    &lt;!-- Main Content Area --&gt;&#10;    &lt;main class=&quot;p-6&quot;&gt;&#10;        &lt;!-- Summary Cards --&gt;&#10;        &lt;div class=&quot;grid grid-cols-1 md:grid-cols-4 gap-6 mb-6&quot;&gt;&#10;            &lt;div class=&quot;bg-white rounded-lg shadow p-6&quot;&gt;&#10;                &lt;div class=&quot;flex items-center&quot;&gt;&#10;                    &lt;div class=&quot;p-3 rounded-full bg-blue-100 text-blue-600&quot;&gt;&#10;                        &lt;i class=&quot;fas fa-file-invoice text-xl&quot;&gt;&lt;/i&gt;&#10;                    &lt;/div&gt;&#10;                    &lt;div class=&quot;ml-4&quot;&gt;&#10;                        &lt;p class=&quot;text-sm font-medium text-gray-600&quot;&gt;Total Bills&lt;/p&gt;&#10;                        &lt;p class=&quot;text-2xl font-semibold text-gray-900&quot;&gt;${totalBills != null ? totalBills : 0}&lt;/p&gt;&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;bg-white rounded-lg shadow p-6&quot;&gt;&#10;                &lt;div class=&quot;flex items-center&quot;&gt;&#10;                    &lt;div class=&quot;p-3 rounded-full bg-green-100 text-green-600&quot;&gt;&#10;                        &lt;i class=&quot;fas fa-check-circle text-xl&quot;&gt;&lt;/i&gt;&#10;                    &lt;/div&gt;&#10;                    &lt;div class=&quot;ml-4&quot;&gt;&#10;                        &lt;p class=&quot;text-sm font-medium text-gray-600&quot;&gt;Paid Bills&lt;/p&gt;&#10;                        &lt;p class=&quot;text-2xl font-semibold text-gray-900&quot;&gt;${paidBills != null ? paidBills : 0}&lt;/p&gt;&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;bg-white rounded-lg shadow p-6&quot;&gt;&#10;                &lt;div class=&quot;flex items-center&quot;&gt;&#10;                    &lt;div class=&quot;p-3 rounded-full bg-red-100 text-red-600&quot;&gt;&#10;                        &lt;i class=&quot;fas fa-exclamation-circle text-xl&quot;&gt;&lt;/i&gt;&#10;                    &lt;/div&gt;&#10;                    &lt;div class=&quot;ml-4&quot;&gt;&#10;                        &lt;p class=&quot;text-sm font-medium text-gray-600&quot;&gt;Unpaid Bills&lt;/p&gt;&#10;                        &lt;p class=&quot;text-2xl font-semibold text-gray-900&quot;&gt;${unpaidBills != null ? unpaidBills : 0}&lt;/p&gt;&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;bg-white rounded-lg shadow p-6&quot;&gt;&#10;                &lt;div class=&quot;flex items-center&quot;&gt;&#10;                    &lt;div class=&quot;p-3 rounded-full bg-yellow-100 text-yellow-600&quot;&gt;&#10;                        &lt;i class=&quot;fas fa-dollar-sign text-xl&quot;&gt;&lt;/i&gt;&#10;                    &lt;/div&gt;&#10;                    &lt;div class=&quot;ml-4&quot;&gt;&#10;                        &lt;p class=&quot;text-sm font-medium text-gray-600&quot;&gt;Total Sales&lt;/p&gt;&#10;                        &lt;p class=&quot;text-2xl font-semibold text-gray-900&quot;&gt;Rs. &lt;fmt:formatNumber value=&quot;${totalSales != null ? totalSales : 0}&quot; pattern=&quot;#,##0.00&quot;/&gt;&lt;/p&gt;&#10;                    &lt;/div&gt;&#10;                &lt;/div&gt;&#10;            &lt;/div&gt;&#10;        &lt;/div&gt;&#10;&#10;        &lt;!-- Filters --&gt;&#10;        &lt;div class=&quot;bg-white rounded-lg shadow mb-6 p-6 no-print&quot;&gt;&#10;            &lt;h2 class=&quot;text-lg font-semibold mb-4 flex items-center&quot;&gt;&#10;                &lt;i class=&quot;fas fa-filter mr-2 text-indigo-600&quot;&gt;&lt;/i&gt; Filters&#10;            &lt;/h2&gt;&#10;            &lt;form action=&quot;BillServlet&quot; method=&quot;get&quot; class=&quot;grid grid-cols-1 md:grid-cols-5 gap-4&quot;&gt;&#10;                &lt;div&gt;&#10;                    &lt;label class=&quot;block text-sm font-medium mb-1&quot;&gt;Payment Status&lt;/label&gt;&#10;                    &lt;select name=&quot;paymentStatus&quot; class=&quot;w-full border border-gray-300 rounded-lg p-2&quot;&gt;&#10;                        &lt;option value=&quot;&quot;&gt;All Status&lt;/option&gt;&#10;                        &lt;option value=&quot;PAID&quot; ${param.paymentStatus == 'PAID' ? 'selected' : ''}&gt;Paid&lt;/option&gt;&#10;                        &lt;option value=&quot;UNPAID&quot; ${param.paymentStatus == 'UNPAID' ? 'selected' : ''}&gt;Unpaid&lt;/option&gt;&#10;                        &lt;option value=&quot;PARTIAL&quot; ${param.paymentStatus == 'PARTIAL' ? 'selected' : ''}&gt;Partial&lt;/option&gt;&#10;                    &lt;/select&gt;&#10;                &lt;/div&gt;&#10;                &lt;div&gt;&#10;                    &lt;label class=&quot;block text-sm font-medium mb-1&quot;&gt;Payment Method&lt;/label&gt;&#10;                    &lt;select name=&quot;paymentMethod&quot; class=&quot;w-full border border-gray-300 rounded-lg p-2&quot;&gt;&#10;                        &lt;option value=&quot;&quot;&gt;All Methods&lt;/option&gt;&#10;                        &lt;option value=&quot;CASH&quot; ${param.paymentMethod == 'CASH' ? 'selected' : ''}&gt;Cash&lt;/option&gt;&#10;                        &lt;option value=&quot;CARD&quot; ${param.paymentMethod == 'CARD' ? 'selected' : ''}&gt;Card&lt;/option&gt;&#10;                        &lt;option value=&quot;ONLINE&quot; ${param.paymentMethod == 'ONLINE' ? 'selected' : ''}&gt;Online&lt;/option&gt;&#10;                        &lt;option value=&quot;CHEQUE&quot; ${param.paymentMethod == 'CHEQUE' ? 'selected' : ''}&gt;Cheque&lt;/option&gt;&#10;                    &lt;/select&gt;&#10;                &lt;/div&gt;&#10;                &lt;div&gt;&#10;                    &lt;label class=&quot;block text-sm font-medium mb-1&quot;&gt;From Date&lt;/label&gt;&#10;                    &lt;input type=&quot;date&quot; name=&quot;fromDate&quot; value=&quot;${param.fromDate}&quot;&#10;                           class=&quot;w-full border border-gray-300 rounded-lg p-2&quot;&gt;&#10;                &lt;/div&gt;&#10;                &lt;div&gt;&#10;                    &lt;label class=&quot;block text-sm font-medium mb-1&quot;&gt;To Date&lt;/label&gt;&#10;                    &lt;input type=&quot;date&quot; name=&quot;toDate&quot; value=&quot;${param.toDate}&quot;&#10;                           class=&quot;w-full border border-gray-300 rounded-lg p-2&quot;&gt;&#10;                &lt;/div&gt;&#10;                &lt;div class=&quot;flex items-end&quot;&gt;&#10;                    &lt;button type=&quot;submit&quot; class=&quot;w-full bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700&quot;&gt;&#10;                        &lt;i class=&quot;fas fa-search mr-2&quot;&gt;&lt;/i&gt; Filter&#10;                    &lt;/button&gt;&#10;                &lt;/div&gt;&#10;            &lt;/form&gt;&#10;        &lt;/div&gt;&#10;&#10;        &lt;!-- Search --&gt;&#10;        &lt;div class=&quot;bg-white rounded-lg shadow mb-6 p-6 no-print&quot;&gt;&#10;            &lt;div class=&quot;flex gap-4&quot;&gt;&#10;                &lt;div class=&quot;flex-1&quot;&gt;&#10;                    &lt;input type=&quot;text&quot; id=&quot;search-input&quot; placeholder=&quot;Search by Bill Number, Customer Name, Email, or Phone...&quot;&#10;                           class=&quot;w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-indigo-500&quot;&gt;&#10;                &lt;/div&gt;&#10;                &lt;button onclick=&quot;clearSearch()&quot; class=&quot;bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600&quot;&gt;&#10;                    &lt;i class=&quot;fas fa-times mr-2&quot;&gt;&lt;/i&gt; Clear&#10;                &lt;/button&gt;&#10;            &lt;/div&gt;&#10;        &lt;/div&gt;&#10;&#10;        &lt;!-- Bills Table --&gt;&#10;        &lt;div class=&quot;bg-white rounded-lg shadow&quot;&gt;&#10;            &lt;div class=&quot;px-6 py-4 border-b border-gray-200&quot;&gt;&#10;                &lt;h2 class=&quot;text-lg font-semibold flex items-center&quot;&gt;&#10;                    &lt;i class=&quot;fas fa-list mr-2 text-indigo-600&quot;&gt;&lt;/i&gt; Bills List&#10;                    &lt;span class=&quot;ml-2 text-sm text-gray-500&quot;&gt;&#10;                        (${bills != null ? bills.size() : 0} bills found)&#10;                    &lt;/span&gt;&#10;                &lt;/h2&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;overflow-x-auto&quot;&gt;&#10;                &lt;table class=&quot;w-full&quot;&gt;&#10;                    &lt;thead class=&quot;bg-gray-50&quot;&gt;&#10;                    &lt;tr&gt;&#10;                        &lt;th class=&quot;px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider&quot;&gt;&#10;                            Bill Details&#10;                        &lt;/th&gt;&#10;                        &lt;th class=&quot;px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider&quot;&gt;&#10;                            Customer&#10;                        &lt;/th&gt;&#10;                        &lt;th class=&quot;px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider&quot;&gt;&#10;                            Books&#10;                        &lt;/th&gt;&#10;                        &lt;th class=&quot;px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider&quot;&gt;&#10;                            Amount&#10;                        &lt;/th&gt;&#10;                        &lt;th class=&quot;px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider&quot;&gt;&#10;                            Payment&#10;                        &lt;/th&gt;&#10;                    &lt;/tr&gt;&#10;                    &lt;/thead&gt;&#10;                    &lt;tbody class=&quot;bg-white divide-y divide-gray-200&quot;&gt;&#10;                    &lt;c:forEach var=&quot;bill&quot; items=&quot;${bills}&quot;&gt;&#10;                        &lt;tr&gt;&#10;                            &lt;td class=&quot;px-6 py-4&quot;&gt;${bill.billNumber}&lt;/td&gt;&#10;                            &lt;td class=&quot;px-6 py-4&quot;&gt;${bill.customerName}&lt;/td&gt;&#10;                            &lt;td class=&quot;px-6 py-4&quot;&gt;&#10;                                &lt;ul&gt;&#10;                                    &lt;c:forEach var=&quot;book&quot; items=&quot;${bill.books}&quot;&gt;&#10;                                        &lt;li&gt;${book.title} (Qty: ${book.quantity})&lt;/li&gt;&#10;                                    &lt;/c:forEach&gt;&#10;                                &lt;/ul&gt;&#10;                            &lt;/td&gt;&#10;                            &lt;td class=&quot;px-6 py-4 text-right&quot;&gt;Rs. ${bill.totalAmount}&lt;/td&gt;&#10;                            &lt;td class=&quot;px-6 py-4 text-center&quot;&gt;${bill.paymentStatus}&lt;/td&gt;&#10;                        &lt;/tr&gt;&#10;                    &lt;/c:forEach&gt;&#10;                    &lt;/tbody&gt;&#10;                &lt;/table&gt;&#10;            &lt;/div&gt;&#10;        &lt;/div&gt;&#10;    &lt;/main&gt;&#10;&lt;/div&gt;&#10;&#10;&lt;!-- Payment Update Modal --&gt;&#10;&lt;div id=&quot;payment-modal&quot; class=&quot;fixed inset-0 bg-gray-600 bg-opacity-50 hidden z-50&quot;&gt;&#10;    &lt;div class=&quot;flex items-center justify-center min-h-screen p-4&quot;&gt;&#10;        &lt;div class=&quot;bg-white rounded-lg max-w-md w-full p-6&quot;&gt;&#10;            &lt;h3 class=&quot;text-lg font-medium mb-4&quot;&gt;Update Payment Status&lt;/h3&gt;&#10;            &lt;form id=&quot;payment-form&quot; method=&quot;post&quot; action=&quot;ViewBillServlet&quot;&gt;&#10;                &lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;updatePayment&quot;&gt;&#10;                &lt;input type=&quot;hidden&quot; name=&quot;billId&quot; id=&quot;modal-bill-id&quot;&gt;&#10;&#10;                &lt;div class=&quot;mb-4&quot;&gt;&#10;                    &lt;label class=&quot;block text-sm font-medium mb-2&quot;&gt;Payment Status&lt;/label&gt;&#10;                    &lt;select name=&quot;paymentStatus&quot; id=&quot;modal-payment-status&quot; class=&quot;w-full border border-gray-300 rounded-lg p-2&quot;&gt;&#10;                        &lt;option value=&quot;PAID&quot;&gt;Paid&lt;/option&gt;&#10;                        &lt;option value=&quot;UNPAID&quot;&gt;Unpaid&lt;/option&gt;&#10;                        &lt;option value=&quot;PARTIAL&quot;&gt;Partial&lt;/option&gt;&#10;                    &lt;/select&gt;&#10;                &lt;/div&gt;&#10;&#10;                &lt;div class=&quot;mb-4&quot;&gt;&#10;                    &lt;label class=&quot;block text-sm font-medium mb-2&quot;&gt;Payment Method&lt;/label&gt;&#10;                    &lt;select name=&quot;paymentMethod&quot; id=&quot;modal-payment-method&quot; class=&quot;w-full border border-gray-300 rounded-lg p-2&quot;&gt;&#10;                        &lt;option value=&quot;CASH&quot;&gt;Cash&lt;/option&gt;&#10;                        &lt;option value=&quot;CARD&quot;&gt;Card&lt;/option&gt;&#10;                        &lt;option value=&quot;ONLINE&quot;&gt;Online&lt;/option&gt;&#10;                        &lt;option value=&quot;CHEQUE&quot;&gt;Cheque&lt;/option&gt;&#10;                    &lt;/select&gt;&#10;                &lt;/div&gt;&#10;&#10;                &lt;div class=&quot;flex justify-end space-x-3&quot;&gt;&#10;                    &lt;button type=&quot;button&quot; onclick=&quot;closePaymentModal()&quot;&#10;                            class=&quot;bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600&quot;&gt;&#10;                        Cancel&#10;                    &lt;/button&gt;&#10;                    &lt;button type=&quot;submit&quot; class=&quot;bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700&quot;&gt;&#10;                        Update&#10;                    &lt;/button&gt;&#10;                &lt;/div&gt;&#10;            &lt;/form&gt;&#10;        &lt;/div&gt;&#10;    &lt;/div&gt;&#10;&lt;/div&gt;&#10;&#10;&lt;!-- Scripts --&gt;&#10;&lt;script&gt;&#10;    // Search functionality&#10;    document.getElementById('search-input').addEventListener('input', function() {&#10;        const searchTerm = this.value.toLowerCase();&#10;        const rows = document.querySelectorAll('.searchable-row');&#10;&#10;        rows.forEach(row =&gt; {&#10;            const searchData = row.getAttribute('data-search').toLowerCase();&#10;            if (searchData.includes(searchTerm)) {&#10;                row.style.display = '';&#10;            } else {&#10;                row.style.display = 'none';&#10;            }&#10;        });&#10;    });&#10;&#10;    // Clear search&#10;    function clearSearch() {&#10;        document.getElementById('search-input').value = '';&#10;        document.querySelectorAll('.searchable-row').forEach(row =&gt; {&#10;            row.style.display = '';&#10;        });&#10;    }&#10;&#10;    // Payment status update&#10;    function updatePaymentStatus(billId, billNumber) {&#10;        document.getElementById('modal-bill-id').value = billId;&#10;        document.getElementById('payment-modal').classList.remove('hidden');&#10;    }&#10;&#10;    function closePaymentModal() {&#10;        document.getElementById('payment-modal').classList.add('hidden');&#10;    }&#10;&#10;    // Delete bill&#10;    function deleteBill(billId, billNumber) {&#10;        if (confirm(`Are you sure you want to delete bill ${billNumber}? This action cannot be undone.`)) {&#10;            window.location.href = `BillServlet?action=delete&amp;id=${billId}`;&#10;        }&#10;    }&#10;&#10;    // Mobile sidebar toggle&#10;    document.getElementById('sidebar-toggle').addEventListener('click', function() {&#10;        const sidebar = document.querySelector('.fixed.inset-y-0.left-0');&#10;        sidebar.classList.toggle('-translate-x-full');&#10;    });&#10;&#10;    // Auto-hide notifications&#10;    setTimeout(() =&gt; {&#10;        document.querySelectorAll('.notification').forEach(el =&gt; el.remove());&#10;    }, 5000);&#10;&lt;/script&gt;&#10;&#10;&lt;/body&gt;&#10;&lt;/html&gt;&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>